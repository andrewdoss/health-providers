-- Initialize SQLite settings
.headers on
.separator ','

DROP TABLE IF EXISTS geo;
DROP TABLE IF EXISTS temp_geo;
DROP TABLE IF EXISTS temp_geo_2011;
DROP TABLE IF EXISTS ruca;
DROP TABLE IF EXISTS temp_ruca;
DROP TABLE IF EXISTS temp_insurance;

-- Create temp_geo table for 2016 ACS tract data
CREATE TABLE temp_tract_16 (
  geo_id_long TEXT,
  geoid INTEGER NOT NULL PRIMARY KEY,
  name TEXT,
  total_pop INTEGER,
  total_pop_err INTEGER,
  born_this_state_total INTEGER,
  born_this_state_total_err INTEGER,
  born_other_state_total INTEGER,
  born_other_state_total_err INTEGER,
  born_outside_us_total INTEGER,
  born_outside_us_total_err INTEGER,
  age_0_5 REAL,
  age_0_5_err REAL,
  born_this_state_age_0_5 REAL,
  born_this_state_age_0_5_err REAL,
  born_other_state_age_0_5 REAL,
  born_other_state_age_0_5_err REAL,
  born_outside_us_age_0_5 REAL,
  born_outside_us_age_0_5_err REAL,
  age_5_17 REAL,
  age_5_17_err REAL,
  born_this_state_age_5_17 REAL,
  born_this_state_age_5_17_err REAL,
  born_other_state_age_5_17 REAL,
  born_other_state_age_5_17_err REAL,
  born_outside_us_age_5_17 REAL,
  born_outside_us_age_5_17_err REAL,
  age_18_24 REAL,
  age_18_24_err REAL,
  born_this_state_age_18_24 REAL,
  born_this_state_age_18_24_err REAL,
  born_other_state_age_18_24 REAL,
  born_other_state_age_18_24_err REAL,
  born_outside_us_age_18_24 REAL,
  born_outside_us_age_18_24_err REAL,
  age_25_44 REAL,
  age_25_44_err REAL,
  born_this_state_age_25_44 REAL,
  born_this_state_age_25_44_err REAL,
  born_other_state_age_25_44 REAL,
  born_other_state_age_25_44_err REAL,
  born_outside_us_age_25_44 REAL,
  born_outside_us_age_25_44_err REAL,
  age_45_54 REAL,
  age_45_54_err REAL,
  born_this_state_age_45_54 REAL,
  born_this_state_age_45_54_err REAL,
  born_other_state_age_45_54 REAL,
  born_other_state_age_45_54_err REAL,
  born_outside_us_age_45_54 REAL,
  born_outside_us_age_45_54_err REAL,
  age_55_64 REAL,
  age_55_64_err REAL,
  born_this_state_age_55_64 REAL,
  born_this_state_age_55_64_err REAL,
  born_other_state_age_55_64 REAL,
  born_other_state_age_55_64_err REAL,
  born_outside_us_age_55_64 REAL,
  born_outside_us_age_55_64_err REAL,
  age_65_74 REAL,
  age_65_74_err REAL,
  born_this_state_age_65_74 REAL,
  born_this_state_age_65_74_err REAL,
  born_other_state_age_65_74 REAL,
  born_other_state_age_65_74_err REAL,
  born_outside_us_age_65_74 REAL,
  born_outside_us_age_65_74_err REAL,
  age_75_plus REAL,
  age_75_plus_err REAL,
  born_this_state_age_75_plus REAL,
  born_this_state_age_75_plus_err REAL,
  born_other_state_age_75_plus REAL,
  born_other_state_age_75_plus_err REAL,
  born_outside_us_age_75_plus REAL,
  born_outside_us_age_75_plus_err REAL,
  median_age REAL,
  median_age_err REAL,
  median_age_born_this_state REAL,
  median_age_born_this_state_err REAL,
  median_age_born_other_state REAL,
  median_age_born_other_state_err REAL,
  median_age_born_outside_us REAL,
  median_age_born_outside_us_err REAL,
  male REAL,
  male_err REAL,
  male_born_this_state REAL,
  male_born_this_state_err REAL,
  male_born_other_state REAL,
  male_born_other_state_err REAL,
  male_born_outside_us REAL,
  male_born_outside_us_err REAL,
  female REAL,
  female_err REAL,
  female_born_this_state REAL,
  female_born_this_state_err REAL,
  female_born_other_state REAL,
  female_born_other_state_err REAL,
  female_born_outside_us REAL,
  female_born_outside_us_err REAL,
  one_race REAL,
  one_race_err REAL,
  one_race_born_this_state REAL,
  one_race_born_this_state_err REAL,
  one_race_born_other_state REAL,
  one_race_born_other_state_err REAL,
  one_race_born_outside_us REAL,
  one_race_born_outside_us_err REAL,
  white_race REAL,
  white_race_err REAL,
  white_race_born_this_state REAL,
  white_race_born_this_state_err REAL,
  white_race_born_other_state REAL,
  white_race_born_other_state_err REAL,
  white_race_born_outside_us REAL,
  white_race_born_outside_us_err REAL,
  black_race REAL,
  black_race_err REAL,
  black_race_born_this_state REAL,
  black_race_born_this_state_err REAL,
  black_race_born_other_state_err REAL,
  black_race_born_other_state REAL,
  black_race_born_outside_us REAL,
  black_race_born_outside_us_err REAL,
  native_race REAL,
  native_race_err REAL,
  native_race_born_this_state REAL,
  native_race_born_this_state_err REAL,
  native_race_born_other_state REAL,
  native_race_born_other_state_err REAL,
  native_race_born_outside_us REAL,
  native_race_born_outside_us_err REAL,
  asian_race REAL,
  asian_race_err REAL,
  asian_race_born_this_state REAL,
  asian_race_born_this_state_err REAL,
  asian_race_born_other_state REAL,
  asian_race_born_other_state_err REAL,
  asian_race_born_outside_us REAL,
  asian_race_born_outside_us_err REAL,
  hawaii_pacific_race REAL,
  hawaii_pacific_race_err REAL,
  hawaii_pacific_race_born_this_state REAL,
  hawaii_pacific_race_born_this_state_err REAL,
  hawaii_pacific_race_born_other_state REAL,
  hawaii_pacific_race_born_other_state_err REAL,
  hawaii_pacific_race_born_outside_us REAL,
  hawaii_pacific_race_born_outside_us_err REAL,
  other_race REAL,
  other_race_err REAL,
  other_race_born_this_state REAL,
  other_race_born_this_state_err REAL,
  other_race_born_other_state REAL,
  other_race_born_other_state_err REAL,
  other_race_born_outside_us REAL,
  other_race_born_outside_us_err REAL,
  multiple_races REAL,
  multiple_races_err REAL,
  multiple_races_born_this_state REAL,
  multiple_races_born_this_state_err REAL,
  multiple_races_born_other_state REAL,
  multiple_races_born_other_state_err REAL,
  multiple_races_born_outside_us REAL,
  multiple_races_born_outside_us_err REAL,
  hispanic_latino REAL,
  hispanic_latino_err REAL,
  hispanic_latino_born_this_state REAL,
  hispanic_latino_born_this_state_err REAL,
  hispanic_latino_born_other_state REAL,
  hispanic_latino_born_other_state_err REAL,
  hispanic_latino_born_outside_us REAL,
  hispanic_latino_born_outside_us_err REAL,
  white_not_hispanic REAL,
  white_not_hispanic_err REAL,
  white_not_hispanic_born_this_state REAL,
  white_not_hispanic_born_this_state_err REAL,
  white_not_hispanic_born_other_state_err REAL,
  white_not_hispanic_born_other_state REAL,
  white_not_hispanic_born_outside_us REAL,
  white_not_hispanic_born_outside_us_err REAL,
  age_5_plus REAL,
  age_5_plus_err REAL,
  age_5_plus_born_this_state REAL,
  age_5_plus_born_this_state_err REAL,
  age_5_plus_born_other_state REAL,
  age_5_plus_born_other_state_err REAL,
  age_5_plus_born_outside_us REAL,
  age_5_plus_born_outside_us_err REAL,
  other_language_home REAL,
  other_language_home_err REAL,
  other_language_home_born_this_state REAL,
  other_language_home_born_this_state_err REAL,
  other_language_home_born_other_state REAL,
  other_language_home_born_other_state_err REAL,
  other_language_home_born_outside_us REAL,
  other_language_home_born_outside_us_err REAL,
  other_language_home_speak_english REAL,
  other_language_home_speak_english_err REAL,
  other_language_home_speak_english_born_this_state REAL,
  other_language_home_speak_english_born_this_state_err REAL,
  other_language_home_speak_english_born_other_state REAL,
  other_language_home_speak_english_born_other_state_err REAL,
  other_language_home_speak_english_born_outside_us REAL,
  other_language_home_speak_english_born_outside_us_err REAL,
  other_language_home_poor_english REAL,
  other_language_home_poor_english_err REAL,
  other_language_home_poor_english_born_this_state REAL,
  other_language_home_poor_english_born_this_state_err REAL,
  other_language_home_poor_english_born_other_state REAL,
  other_language_home_poor_english_born_other_state_err REAL,
  other_language_home_poor_english_born_outside_us REAL,
  other_language_home_poor_english_born_outside_us_err REAL,
  age_15_plus REAL,
  age_15_plus_err REAL,
  age_15_plus_born_this_state REAL,
  age_15_plus_born_this_state_err REAL,
  age_15_plus_born_other_state REAL,
  age_15_plus_born_other_state_err REAL,
  age_15_plus_born_outside_us REAL,
  age_15_plus_born_outside_us_err REAL,
  never_married REAL,
  never_married_err REAL,
  never_married_born_this_state REAL,
  never_married_born_this_state_err REAL,
  never_married_born_other_state REAL,
  never_married_born_other_state_err REAL,
  never_married_born_outside_us REAL,
  never_married_born_outside_us_err REAL,
  now_married_separated REAL,
  now_married_separated_err REAL,
  now_married_separated_born_this_state REAL,
  now_married_separated_born_this_state_err REAL,
  now_married_separated_born_other_state REAL,
  now_married_separated_born_other_state_err REAL,
  now_married_separated_born_outside_us REAL,
  now_married_separated_born_outside_us_err REAL,
  divorced_separated REAL,
  divorced_separated_err REAL,
  divorced_separated_born_this_state REAL,
  divorced_separated_born_this_state_err REAL,
  divorced_separated_born_other_state REAL,
  divorced_separated_born_other_state_err REAL,
  divorced_separated_born_outside_us REAL,
  divorced_separated_born_outside_us_err REAL,
  widowed REAL,
  widowed_err REAL,
  widowed_born_this_state REAL,
  widowed_born_this_state_err REAL,
  widowed_born_other_state REAL,
  widowed_born_other_state_err REAL,
  widowed_born_outside_us REAL,
  widowed_born_outside_us_err REAL,
  age_25_plus REAL,
  age_25_plus_err REAL,
  age_25_plus_born_this_state REAL,
  age_25_plus_born_this_state_err REAL,
  age_25_plus_born_other_state REAL,
  age_25_plus_born_other_state_err REAL,
  age_25_plus_born_outside_us REAL,
  age_25_plus_born_outside_us_err REAL,
  ed_less_than_hs REAL,
  ed_less_than_hs_err REAL,
  ed_less_than_hs_born_this_state REAL,
  ed_less_than_hs_born_this_state_err REAL,
  ed_less_than_hs_born_other_state REAL,
  ed_less_than_hs_born_other_state_err REAL,
  ed_less_than_hs_born_outside_us REAL,
  ed_less_than_hs_born_outside_us_err REAL,
  ed_hs_grad REAL,
  ed_hs_grad_err REAL,
  ed_hs_grad_born_this_state REAL,
  ed_hs_grad_born_this_state_err REAL,
  ed_hs_grad_born_other_state REAL,
  ed_hs_grad_born_other_state_err REAL,
  ed_hs_grad_born_outside_us REAL,
  ed_hs_grad_born_outside_us_err REAL,
  ed_some_college REAL,
  ed_some_college_err REAL,
  ed_some_college_born_this_state REAL,
  ed_some_college_born_this_state_err REAL,
  ed_some_college_born_other_state REAL,
  ed_some_college_born_other_state_err REAL,
  ed_some_college_born_outside_us REAL,
  ed_some_college_born_outside_us_err REAL,
  ed_bachelors REAL,
  ed_bachelors_err REAL,
  ed_bachelors_born_this_state REAL,
  ed_bachelors_born_this_state_err REAL,
  ed_bachelors_born_other_state REAL,
  ed_bachelors_born_other_state_err REAL,
  ed_bachelors_born_outside_us REAL,
  ed_bachelors_born_outside_us_err REAL,
  ed_graduate_prof_deg REAL,
  ed_graduate_prof_deg_err REAL,
  ed_graduate_prof_deg_born_this_state REAL,
  ed_graduate_prof_deg_born_this_state_err REAL,
  ed_graduate_prof_deg_born_other_state REAL,
  ed_graduate_prof_deg_born_other_state_err REAL,
  ed_graduate_prof_deg_born_outside_us REAL,
  ed_graduate_prof_deg_born_outside_us_err REAL,
  age_15_plus_inc REAL,
  age_15_plus_inc_err REAL,
  age_15_plus_inc_born_this_state REAL,
  age_15_plus_inc_born_this_state_err REAL,
  age_15_plus_inc_born_other_state REAL,
  age_15_plus_inc_born_other_state_err REAL,
  age_15_plus_inc_born_outside_us REAL,
  age_15_plus_inc_born_outside_us_err REAL,
  income_1_10k REAL,
  income_1_10k_err REAL,
  income_1_10k_born_this_state REAL,
  income_1_10k_born_this_state_err REAL,
  income_1_10k_born_other_state REAL,
  income_1_10k_born_other_state_err REAL,
  income_1_10k_born_outside_us REAL,
  income_1_10k_born_outside_us_err REAL,
  income_10k_15k REAL,
  income_10k_15k_err REAL,
  income_10k_15k_born_this_state REAL,
  income_10k_15k_born_this_state_err REAL,
  income_10k_15k_born_other_state REAL,
  income_10k_15k_born_other_state_err REAL,
  income_10k_15k_born_outside_us REAL,
  income_10k_15k_born_outside_us_err REAL,
  income_15k_25k REAL,
  income_15k_25k_err REAL,
  income_15k_25k_born_this_state REAL,
  income_15k_25k_born_this_state_err REAL,
  income_15k_25k_born_other_state REAL,
  income_15k_25k_born_other_state_err REAL,
  income_15k_25k_born_outside_us REAL,
  income_15k_25k_born_outside_us_err REAL,
  income_25k_35k REAL,
  income_25k_35k_err REAL,
  income_25k_35k_born_this_state REAL,
  income_25k_35k_born_this_state_err REAL,
  income_25k_35k_born_other_state REAL,
  income_25k_35k_born_other_state_err REAL,
  income_25k_35k_born_outside_us REAL,
  income_25k_35k_born_outside_us_err REAL,
  income_35k_50k REAL,
  income_35k_50k_err REAL,
  income_35k_50k_born_this_state REAL,
  income_35k_50k_born_this_state_err REAL,
  income_35k_50k_born_other_state REAL,
  income_35k_50k_born_other_state_err REAL,
  income_35k_50k_born_outside_us REAL,
  income_35k_50k_born_outside_us_err REAL,
  income_50k_65k REAL,
  income_50k_65k_err REAL,
  income_50k_65k_born_this_state REAL,
  income_50k_65k_born_this_state_err REAL,
  income_50k_65k_born_other_state REAL,
  income_50k_65k_born_other_state_err REAL,
  income_50k_65k_born_outside_us REAL,
  income_50k_65k_born_outside_us_err REAL,
  income_65k_75k REAL,
  income_65k_75k_err REAL,
  income_65k_75k_born_this_state REAL,
  income_65k_75k_born_this_state_err REAL,
  income_65k_75k_born_other_state REAL,
  income_65k_75k_born_other_state_err REAL,
  income_65k_75k_born_outside_us REAL,
  income_65k_75k_born_outside_us_err REAL,
  income_75k_plus REAL,
  income_75k_plus_err REAL,
  income_75k_plus_born_this_state REAL,
  income_75k_plus_born_this_state_err REAL,
  income_75k_plus_born_other_state REAL,
  income_75k_plus_born_other_state_err REAL,
  income_75k_plus_born_outside_us REAL,
  income_75k_plus_born_outside_us_err REAL,
  median_income REAL,
  median_income_err REAL,
  median_income_born_this_state REAL,
  median_income_born_this_state_err REAL,
  median_income_born_other_state REAL,
  median_incomes_born_other_state_err REAL,
  median_income_born_outside_us REAL,
  median_income_born_outside_us_err REAL,
  poverty_status_known REAL,
  poverty_status_known_err REAL,
  poverty_status_known_born_this_state REAL,
  poverty_status_known_born_this_state_err REAL,
  poverty_status_known_born_other_state REAL,
  poverty_status_known_born_other_state_err REAL,
  poverty_status_known_born_outside_us REAL,
  poverty_status_known_born_outside_us_err REAL,
  below_poverty REAL,
  below_poverty_err REAL,
  below_poverty_born_this_state REAL,
  below_poverty_born_this_state_err REAL,
  below_poverty_born_other_state REAL,
  below_poverty_born_other_state_err REAL,
  below_poverty_born_outside_us REAL,
  below_poverty_born_outside_us_err REAL,
  below_100_150perc_poverty REAL,
  below_100_150perc_poverty_err REAL,
  below_100_150perc_poverty_born_this_state REAL,
  below_100_150perc_poverty_born_this_state_err REAL,
  below_100_150perc_poverty_born_other_state REAL,
  below_100_150perc_poverty_born_other_state_err REAL,
  below_100_150perc_poverty_born_outside_us REAL,
  below_100_150perc_poverty_born_outside_us_err REAL,
  above_150perc_poverty REAL,
  above_150perc_poverty_err REAL,
  above_150perc_poverty_born_this_state REAL,
  above_150perc_poverty_born_this_state_err REAL,
  above_150perc_poverty_born_other_state REAL,
  above_150perc_poverty_born_other_state_err REAL,
  above_150perc_poverty_born_outside_us REAL,
  above_150perc_poverty_born_outside_us_err REAL,
  citizen_status REAL,
  citizen_status_err REAL,
  citizen_status_born_this_state REAL,
  citizen_status_born_this_state_err REAL,
  citizen_status_born_other_state REAL,
  citizen_status_born_other_state_err REAL,
  citizen_status_born_outside_us REAL,
  citizen_status_born_outside_us_err REAL,
  place_of_birth REAL,
  place_of_birth_err REAL,
  place_of_birth_born_this_state REAL,
  place_of_birth_born_this_state_err REAL,
  place_of_birth_born_other_state REAL,
  place_of_birth_born_other_state_err REAL,
  place_of_birth_born_outside_us REAL,
  place_of_birth_born_outside_us_err REAL);

-- Create temp_geo for ACS 2011 tract data
CREATE TABLE temp_tract_11(
  geo_id_long TEXT,
  geoid INTEGER NOT NULL PRIMARY KEY,
  name TEXT,
  total_pop INTEGER,
  total_pop_err INTEGER,
  born_this_state_total INTEGER,
  born_this_state_total_err INTEGER,
  born_other_state_total INTEGER,
  born_other_state_total_err INTEGER,
  born_outside_us_total INTEGER,
  born_outside_us_total_err INTEGER,
  age_0_5 REAL,
  age_0_5_err REAL,
  born_this_state_age_0_5 REAL,
  born_this_state_age_0_5_err REAL,
  born_other_state_age_0_5 REAL,
  born_other_state_age_0_5_err REAL,
  born_outside_us_age_0_5 REAL,
  born_outside_us_age_0_5_err REAL,
  age_5_17 REAL,
  age_5_17_err REAL,
  born_this_state_age_5_17 REAL,
  born_this_state_age_5_17_err REAL,
  born_other_state_age_5_17 REAL,
  born_other_state_age_5_17_err REAL,
  born_outside_us_age_5_17 REAL,
  born_outside_us_age_5_17_err REAL,
  age_18_24 REAL,
  age_18_24_err REAL,
  born_this_state_age_18_24 REAL,
  born_this_state_age_18_24_err REAL,
  born_other_state_age_18_24 REAL,
  born_other_state_age_18_24_err REAL,
  born_outside_us_age_18_24 REAL,
  born_outside_us_age_18_24_err REAL,
  age_25_44 REAL,
  age_25_44_err REAL,
  born_this_state_age_25_44 REAL,
  born_this_state_age_25_44_err REAL,
  born_other_state_age_25_44 REAL,
  born_other_state_age_25_44_err REAL,
  born_outside_us_age_25_44 REAL,
  born_outside_us_age_25_44_err REAL,
  age_45_54 REAL,
  age_45_54_err REAL,
  born_this_state_age_45_54 REAL,
  born_this_state_age_45_54_err REAL,
  born_other_state_age_45_54 REAL,
  born_other_state_age_45_54_err REAL,
  born_outside_us_age_45_54 REAL,
  born_outside_us_age_45_54_err REAL,
  age_55_64 REAL,
  age_55_64_err REAL,
  born_this_state_age_55_64 REAL,
  born_this_state_age_55_64_err REAL,
  born_other_state_age_55_64 REAL,
  born_other_state_age_55_64_err REAL,
  born_outside_us_age_55_64 REAL,
  born_outside_us_age_55_64_err REAL,
  age_65_74 REAL,
  age_65_74_err REAL,
  born_this_state_age_65_74 REAL,
  born_this_state_age_65_74_err REAL,
  born_other_state_age_65_74 REAL,
  born_other_state_age_65_74_err REAL,
  born_outside_us_age_65_74 REAL,
  born_outside_us_age_65_74_err REAL,
  age_75_plus REAL,
  age_75_plus_err REAL,
  born_this_state_age_75_plus REAL,
  born_this_state_age_75_plus_err REAL,
  born_other_state_age_75_plus REAL,
  born_other_state_age_75_plus_err REAL,
  born_outside_us_age_75_plus REAL,
  born_outside_us_age_75_plus_err REAL,
  median_age REAL,
  median_age_err REAL,
  median_age_born_this_state REAL,
  median_age_born_this_state_err REAL,
  median_age_born_other_state REAL,
  median_age_born_other_state_err REAL,
  median_age_born_outside_us REAL,
  median_age_born_outside_us_err REAL,
  male REAL,
  male_err REAL,
  male_born_this_state REAL,
  male_born_this_state_err REAL,
  male_born_other_state REAL,
  male_born_other_state_err REAL,
  male_born_outside_us REAL,
  male_born_outside_us_err REAL,
  female REAL,
  female_err REAL,
  female_born_this_state REAL,
  female_born_this_state_err REAL,
  female_born_other_state REAL,
  female_born_other_state_err REAL,
  female_born_outside_us REAL,
  female_born_outside_us_err REAL,
  one_race REAL,
  one_race_err REAL,
  one_race_born_this_state REAL,
  one_race_born_this_state_err REAL,
  one_race_born_other_state REAL,
  one_race_born_other_state_err REAL,
  one_race_born_outside_us REAL,
  one_race_born_outside_us_err REAL,
  white_race REAL,
  white_race_err REAL,
  white_race_born_this_state REAL,
  white_race_born_this_state_err REAL,
  white_race_born_other_state REAL,
  white_race_born_other_state_err REAL,
  white_race_born_outside_us REAL,
  white_race_born_outside_us_err REAL,
  black_race REAL,
  black_race_err REAL,
  black_race_born_this_state REAL,
  black_race_born_this_state_err REAL,
  black_race_born_other_state_err REAL,
  black_race_born_other_state REAL,
  black_race_born_outside_us REAL,
  black_race_born_outside_us_err REAL,
  native_race REAL,
  native_race_err REAL,
  native_race_born_this_state REAL,
  native_race_born_this_state_err REAL,
  native_race_born_other_state REAL,
  native_race_born_other_state_err REAL,
  native_race_born_outside_us REAL,
  native_race_born_outside_us_err REAL,
  asian_race REAL,
  asian_race_err REAL,
  asian_race_born_this_state REAL,
  asian_race_born_this_state_err REAL,
  asian_race_born_other_state REAL,
  asian_race_born_other_state_err REAL,
  asian_race_born_outside_us REAL,
  asian_race_born_outside_us_err REAL,
  hawaii_pacific_race REAL,
  hawaii_pacific_race_err REAL,
  hawaii_pacific_race_born_this_state REAL,
  hawaii_pacific_race_born_this_state_err REAL,
  hawaii_pacific_race_born_other_state REAL,
  hawaii_pacific_race_born_other_state_err REAL,
  hawaii_pacific_race_born_outside_us REAL,
  hawaii_pacific_race_born_outside_us_err REAL,
  other_race REAL,
  other_race_err REAL,
  other_race_born_this_state REAL,
  other_race_born_this_state_err REAL,
  other_race_born_other_state REAL,
  other_race_born_other_state_err REAL,
  other_race_born_outside_us REAL,
  other_race_born_outside_us_err REAL,
  multiple_races REAL,
  multiple_races_err REAL,
  multiple_races_born_this_state REAL,
  multiple_races_born_this_state_err REAL,
  multiple_races_born_other_state REAL,
  multiple_races_born_other_state_err REAL,
  multiple_races_born_outside_us REAL,
  multiple_races_born_outside_us_err REAL,
  hispanic_latino REAL,
  hispanic_latino_err REAL,
  hispanic_latino_born_this_state REAL,
  hispanic_latino_born_this_state_err REAL,
  hispanic_latino_born_other_state REAL,
  hispanic_latino_born_other_state_err REAL,
  hispanic_latino_born_outside_us REAL,
  hispanic_latino_born_outside_us_err REAL,
  white_not_hispanic REAL,
  white_not_hispanic_err REAL,
  white_not_hispanic_born_this_state REAL,
  white_not_hispanic_born_this_state_err REAL,
  white_not_hispanic_born_other_state_err REAL,
  white_not_hispanic_born_other_state REAL,
  white_not_hispanic_born_outside_us REAL,
  white_not_hispanic_born_outside_us_err REAL,
  age_5_plus REAL,
  age_5_plus_err REAL,
  age_5_plus_born_this_state REAL,
  age_5_plus_born_this_state_err REAL,
  age_5_plus_born_other_state REAL,
  age_5_plus_born_other_state_err REAL,
  age_5_plus_born_outside_us REAL,
  age_5_plus_born_outside_us_err REAL,
  other_language_home REAL,
  other_language_home_err REAL,
  other_language_home_born_this_state REAL,
  other_language_home_born_this_state_err REAL,
  other_language_home_born_other_state REAL,
  other_language_home_born_other_state_err REAL,
  other_language_home_born_outside_us REAL,
  other_language_home_born_outside_us_err REAL,
  other_language_home_speak_english REAL,
  other_language_home_speak_english_err REAL,
  other_language_home_speak_english_born_this_state REAL,
  other_language_home_speak_english_born_this_state_err REAL,
  other_language_home_speak_english_born_other_state REAL,
  other_language_home_speak_english_born_other_state_err REAL,
  other_language_home_speak_english_born_outside_us REAL,
  other_language_home_speak_english_born_outside_us_err REAL,
  other_language_home_poor_english REAL,
  other_language_home_poor_english_err REAL,
  other_language_home_poor_english_born_this_state REAL,
  other_language_home_poor_english_born_this_state_err REAL,
  other_language_home_poor_english_born_other_state REAL,
  other_language_home_poor_english_born_other_state_err REAL,
  other_language_home_poor_english_born_outside_us REAL,
  other_language_home_poor_english_born_outside_us_err REAL,
  age_15_plus REAL,
  age_15_plus_err REAL,
  age_15_plus_born_this_state REAL,
  age_15_plus_born_this_state_err REAL,
  age_15_plus_born_other_state REAL,
  age_15_plus_born_other_state_err REAL,
  age_15_plus_born_outside_us REAL,
  age_15_plus_born_outside_us_err REAL,
  never_married REAL,
  never_married_err REAL,
  never_married_born_this_state REAL,
  never_married_born_this_state_err REAL,
  never_married_born_other_state REAL,
  never_married_born_other_state_err REAL,
  never_married_born_outside_us REAL,
  never_married_born_outside_us_err REAL,
  now_married_separated REAL,
  now_married_separated_err REAL,
  now_married_separated_born_this_state REAL,
  now_married_separated_born_this_state_err REAL,
  now_married_separated_born_other_state REAL,
  now_married_separated_born_other_state_err REAL,
  now_married_separated_born_outside_us REAL,
  now_married_separated_born_outside_us_err REAL,
  divorced_separated REAL,
  divorced_separated_err REAL,
  divorced_separated_born_this_state REAL,
  divorced_separated_born_this_state_err REAL,
  divorced_separated_born_other_state REAL,
  divorced_separated_born_other_state_err REAL,
  divorced_separated_born_outside_us REAL,
  divorced_separated_born_outside_us_err REAL,
  widowed REAL,
  widowed_err REAL,
  widowed_born_this_state REAL,
  widowed_born_this_state_err REAL,
  widowed_born_other_state REAL,
  widowed_born_other_state_err REAL,
  widowed_born_outside_us REAL,
  widowed_born_outside_us_err REAL,
  age_25_plus REAL,
  age_25_plus_err REAL,
  age_25_plus_born_this_state REAL,
  age_25_plus_born_this_state_err REAL,
  age_25_plus_born_other_state REAL,
  age_25_plus_born_other_state_err REAL,
  age_25_plus_born_outside_us REAL,
  age_25_plus_born_outside_us_err REAL,
  ed_less_than_hs REAL,
  ed_less_than_hs_err REAL,
  ed_less_than_hs_born_this_state REAL,
  ed_less_than_hs_born_this_state_err REAL,
  ed_less_than_hs_born_other_state REAL,
  ed_less_than_hs_born_other_state_err REAL,
  ed_less_than_hs_born_outside_us REAL,
  ed_less_than_hs_born_outside_us_err REAL,
  ed_hs_grad REAL,
  ed_hs_grad_err REAL,
  ed_hs_grad_born_this_state REAL,
  ed_hs_grad_born_this_state_err REAL,
  ed_hs_grad_born_other_state REAL,
  ed_hs_grad_born_other_state_err REAL,
  ed_hs_grad_born_outside_us REAL,
  ed_hs_grad_born_outside_us_err REAL,
  ed_some_college REAL,
  ed_some_college_err REAL,
  ed_some_college_born_this_state REAL,
  ed_some_college_born_this_state_err REAL,
  ed_some_college_born_other_state REAL,
  ed_some_college_born_other_state_err REAL,
  ed_some_college_born_outside_us REAL,
  ed_some_college_born_outside_us_err REAL,
  ed_bachelors REAL,
  ed_bachelors_err REAL,
  ed_bachelors_born_this_state REAL,
  ed_bachelors_born_this_state_err REAL,
  ed_bachelors_born_other_state REAL,
  ed_bachelors_born_other_state_err REAL,
  ed_bachelors_born_outside_us REAL,
  ed_bachelors_born_outside_us_err REAL,
  ed_graduate_prof_deg REAL,
  ed_graduate_prof_deg_err REAL,
  ed_graduate_prof_deg_born_this_state REAL,
  ed_graduate_prof_deg_born_this_state_err REAL,
  ed_graduate_prof_deg_born_other_state REAL,
  ed_graduate_prof_deg_born_other_state_err REAL,
  ed_graduate_prof_deg_born_outside_us REAL,
  ed_graduate_prof_deg_born_outside_us_err REAL,
  age_15_plus_inc REAL,
  age_15_plus_inc_err REAL,
  age_15_plus_inc_born_this_state REAL,
  age_15_plus_inc_born_this_state_err REAL,
  age_15_plus_inc_born_other_state REAL,
  age_15_plus_inc_born_other_state_err REAL,
  age_15_plus_inc_born_outside_us REAL,
  age_15_plus_inc_born_outside_us_err REAL,
  income_1_10k REAL,
  income_1_10k_err REAL,
  income_1_10k_born_this_state REAL,
  income_1_10k_born_this_state_err REAL,
  income_1_10k_born_other_state REAL,
  income_1_10k_born_other_state_err REAL,
  income_1_10k_born_outside_us REAL,
  income_1_10k_born_outside_us_err REAL,
  income_10k_15k REAL,
  income_10k_15k_err REAL,
  income_10k_15k_born_this_state REAL,
  income_10k_15k_born_this_state_err REAL,
  income_10k_15k_born_other_state REAL,
  income_10k_15k_born_other_state_err REAL,
  income_10k_15k_born_outside_us REAL,
  income_10k_15k_born_outside_us_err REAL,
  income_15k_25k REAL,
  income_15k_25k_err REAL,
  income_15k_25k_born_this_state REAL,
  income_15k_25k_born_this_state_err REAL,
  income_15k_25k_born_other_state REAL,
  income_15k_25k_born_other_state_err REAL,
  income_15k_25k_born_outside_us REAL,
  income_15k_25k_born_outside_us_err REAL,
  income_25k_35k REAL,
  income_25k_35k_err REAL,
  income_25k_35k_born_this_state REAL,
  income_25k_35k_born_this_state_err REAL,
  income_25k_35k_born_other_state REAL,
  income_25k_35k_born_other_state_err REAL,
  income_25k_35k_born_outside_us REAL,
  income_25k_35k_born_outside_us_err REAL,
  income_35k_50k REAL,
  income_35k_50k_err REAL,
  income_35k_50k_born_this_state REAL,
  income_35k_50k_born_this_state_err REAL,
  income_35k_50k_born_other_state REAL,
  income_35k_50k_born_other_state_err REAL,
  income_35k_50k_born_outside_us REAL,
  income_35k_50k_born_outside_us_err REAL,
  income_50k_65k REAL,
  income_50k_65k_err REAL,
  income_50k_65k_born_this_state REAL,
  income_50k_65k_born_this_state_err REAL,
  income_50k_65k_born_other_state REAL,
  income_50k_65k_born_other_state_err REAL,
  income_50k_65k_born_outside_us REAL,
  income_50k_65k_born_outside_us_err REAL,
  income_65k_75k REAL,
  income_65k_75k_err REAL,
  income_65k_75k_born_this_state REAL,
  income_65k_75k_born_this_state_err REAL,
  income_65k_75k_born_other_state REAL,
  income_65k_75k_born_other_state_err REAL,
  income_65k_75k_born_outside_us REAL,
  income_65k_75k_born_outside_us_err REAL,
  income_75k_plus REAL,
  income_75k_plus_err REAL,
  income_75k_plus_born_this_state REAL,
  income_75k_plus_born_this_state_err REAL,
  income_75k_plus_born_other_state REAL,
  income_75k_plus_born_other_state_err REAL,
  income_75k_plus_born_outside_us REAL,
  income_75k_plus_born_outside_us_err REAL,
  median_income REAL,
  median_income_err REAL,
  median_income_born_this_state REAL,
  median_income_born_this_state_err REAL,
  median_income_born_other_state REAL,
  median_incomes_born_other_state_err REAL,
  median_income_born_outside_us REAL,
  median_income_born_outside_us_err REAL,
  poverty_status_known REAL,
  poverty_status_known_err REAL,
  poverty_status_known_born_this_state REAL,
  poverty_status_known_born_this_state_err REAL,
  poverty_status_known_born_other_state REAL,
  poverty_status_known_born_other_state_err REAL,
  poverty_status_known_born_outside_us REAL,
  poverty_status_known_born_outside_us_err REAL,
  below_poverty REAL,
  below_poverty_err REAL,
  below_poverty_born_this_state REAL,
  below_poverty_born_this_state_err REAL,
  below_poverty_born_other_state REAL,
  below_poverty_born_other_state_err REAL,
  below_poverty_born_outside_us REAL,
  below_poverty_born_outside_us_err REAL,
  below_100_150perc_poverty REAL,
  below_100_150perc_poverty_err REAL,
  below_100_150perc_poverty_born_this_state REAL,
  below_100_150perc_poverty_born_this_state_err REAL,
  below_100_150perc_poverty_born_other_state REAL,
  below_100_150perc_poverty_born_other_state_err REAL,
  below_100_150perc_poverty_born_outside_us REAL,
  below_100_150perc_poverty_born_outside_us_err REAL,
  above_150perc_poverty REAL,
  above_150perc_poverty_err REAL,
  above_150perc_poverty_born_this_state REAL,
  above_150perc_poverty_born_this_state_err REAL,
  above_150perc_poverty_born_other_state REAL,
  above_150perc_poverty_born_other_state_err REAL,
  above_150perc_poverty_born_outside_us REAL,
  above_150perc_poverty_born_outside_us_err REAL,
  citizen_status REAL,
  citizen_status_err REAL,
  citizen_status_born_this_state REAL,
  citizen_status_born_this_state_err REAL,
  citizen_status_born_other_state REAL,
  citizen_status_born_other_state_err REAL,
  citizen_status_born_outside_us REAL,
  citizen_status_born_outside_us_err REAL,
  place_of_birth REAL,
  place_of_birth_err REAL,
  place_of_birth_born_this_state REAL,
  place_of_birth_born_this_state_err REAL,
  place_of_birth_born_other_state REAL,
  place_of_birth_born_other_state_err REAL,
  place_of_birth_born_outside_us REAL,
  place_of_birth_born_outside_us_err REAL);

-- Create 2016 geo table without unneeded columns
CREATE TABLE tract_16 (
  geoid INTEGER NOT NULL PRIMARY KEY,
  name TEXT,
  state TEXT,
  county TEXT,
  primary_ruca INTEGER,
  secondary_ruca INTEGER,
  land_area REAL,
  perc_insured REAL,
  perc_under_18_insured REAL,
  avg_household_size REAL,
  unemployment_rate REAL,
  total_pop INTEGER,
  age_0_5 REAL,
  age_5_17 REAL,
  age_18_24 REAL,
  age_25_44 REAL,
  age_45_54 REAL,
  age_55_64 REAL,
  age_65_74 REAL,
  age_75_plus REAL,
  median_age REAL,
  male REAL,
  female REAL,
  one_race REAL,
  white_race REAL,
  black_race REAL,
  native_race REAL,
  asian_race REAL,
  hawaii_pacific_race REAL,
  other_race REAL,
  multiple_races REAL,
  hispanic_latino REAL,
  white_not_hispanic REAL,
  age_5_plus REAL,
  other_language_home REAL,
  other_language_home_speak_english REAL,
  other_language_home_poor_english REAL,
  age_15_plus REAL,
  never_married REAL,
  now_married_separated REAL,
  divorced_separated REAL,
  widowed REAL,
  age_25_plus REAL,
  ed_less_than_hs REAL,
  ed_hs_grad REAL,
  ed_some_college REAL,
  ed_bachelors REAL,
  ed_graduate_prof_deg REAL,
  age_15_plus_inc REAL,
  income_1_10k REAL,
  income_10k_15k REAL,
  income_15k_25k REAL,
  income_25k_35k REAL,
  income_35k_50k REAL,
  income_50k_65k REAL,
  income_65k_75k REAL,
  income_75k_plus REAL,
  median_income REAL,
  poverty_status_known REAL,
  below_poverty REAL,
  below_100_150perc_poverty REAL,
  above_150perc_poverty REAL,
  citizen_status REAL,
  place_of_birth REAL,
  lat REAL,
  lon REAL);

  -- Create 2011 ACS geo table without unneeded columns
  CREATE TABLE tract_11 (
    geoid INTEGER NOT NULL PRIMARY KEY,
    name TEXT,
    avg_household_size REAL,
    unemployment_rate REAL,
    total_pop INTEGER,
    age_0_5 REAL,
    age_5_17 REAL,
    age_18_24 REAL,
    age_25_44 REAL,
    age_45_54 REAL,
    age_55_64 REAL,
    age_65_74 REAL,
    age_75_plus REAL,
    median_age REAL,
    male REAL,
    female REAL,
    one_race REAL,
    white_race REAL,
    black_race REAL,
    native_race REAL,
    asian_race REAL,
    hawaii_pacific_race REAL,
    other_race REAL,
    multiple_races REAL,
    hispanic_latino REAL,
    white_not_hispanic REAL,
    age_5_plus REAL,
    other_language_home REAL,
    other_language_home_speak_english REAL,
    other_language_home_poor_english REAL,
    age_15_plus REAL,
    never_married REAL,
    now_married_separated REAL,
    divorced_separated REAL,
    widowed REAL,
    age_25_plus REAL,
    ed_less_than_hs REAL,
    ed_hs_grad REAL,
    ed_some_college REAL,
    ed_bachelors REAL,
    ed_graduate_prof_deg REAL,
    age_15_plus_inc REAL,
    income_1_10k REAL,
    income_10k_15k REAL,
    income_15k_25k REAL,
    income_25k_35k REAL,
    income_35k_50k REAL,
    income_50k_65k REAL,
    income_65k_75k REAL,
    income_75k_plus REAL,
    median_income REAL,
    poverty_status_known REAL,
    below_poverty REAL,
    below_100_150perc_poverty REAL,
    above_150perc_poverty REAL,
    citizen_status REAL,
    place_of_birth REAL);

    -- Create temp_geo table for 2016 ACS tract data
    CREATE TABLE temp_county_16 (
      geo_id_long TEXT,
      geoid INTEGER NOT NULL PRIMARY KEY,
      name TEXT,
      total_pop INTEGER,
      total_pop_err INTEGER,
      born_this_state_total INTEGER,
      born_this_state_total_err INTEGER,
      born_other_state_total INTEGER,
      born_other_state_total_err INTEGER,
      born_outside_us_total INTEGER,
      born_outside_us_total_err INTEGER,
      age_0_5 REAL,
      age_0_5_err REAL,
      born_this_state_age_0_5 REAL,
      born_this_state_age_0_5_err REAL,
      born_other_state_age_0_5 REAL,
      born_other_state_age_0_5_err REAL,
      born_outside_us_age_0_5 REAL,
      born_outside_us_age_0_5_err REAL,
      age_5_17 REAL,
      age_5_17_err REAL,
      born_this_state_age_5_17 REAL,
      born_this_state_age_5_17_err REAL,
      born_other_state_age_5_17 REAL,
      born_other_state_age_5_17_err REAL,
      born_outside_us_age_5_17 REAL,
      born_outside_us_age_5_17_err REAL,
      age_18_24 REAL,
      age_18_24_err REAL,
      born_this_state_age_18_24 REAL,
      born_this_state_age_18_24_err REAL,
      born_other_state_age_18_24 REAL,
      born_other_state_age_18_24_err REAL,
      born_outside_us_age_18_24 REAL,
      born_outside_us_age_18_24_err REAL,
      age_25_44 REAL,
      age_25_44_err REAL,
      born_this_state_age_25_44 REAL,
      born_this_state_age_25_44_err REAL,
      born_other_state_age_25_44 REAL,
      born_other_state_age_25_44_err REAL,
      born_outside_us_age_25_44 REAL,
      born_outside_us_age_25_44_err REAL,
      age_45_54 REAL,
      age_45_54_err REAL,
      born_this_state_age_45_54 REAL,
      born_this_state_age_45_54_err REAL,
      born_other_state_age_45_54 REAL,
      born_other_state_age_45_54_err REAL,
      born_outside_us_age_45_54 REAL,
      born_outside_us_age_45_54_err REAL,
      age_55_64 REAL,
      age_55_64_err REAL,
      born_this_state_age_55_64 REAL,
      born_this_state_age_55_64_err REAL,
      born_other_state_age_55_64 REAL,
      born_other_state_age_55_64_err REAL,
      born_outside_us_age_55_64 REAL,
      born_outside_us_age_55_64_err REAL,
      age_65_74 REAL,
      age_65_74_err REAL,
      born_this_state_age_65_74 REAL,
      born_this_state_age_65_74_err REAL,
      born_other_state_age_65_74 REAL,
      born_other_state_age_65_74_err REAL,
      born_outside_us_age_65_74 REAL,
      born_outside_us_age_65_74_err REAL,
      age_75_plus REAL,
      age_75_plus_err REAL,
      born_this_state_age_75_plus REAL,
      born_this_state_age_75_plus_err REAL,
      born_other_state_age_75_plus REAL,
      born_other_state_age_75_plus_err REAL,
      born_outside_us_age_75_plus REAL,
      born_outside_us_age_75_plus_err REAL,
      median_age REAL,
      median_age_err REAL,
      median_age_born_this_state REAL,
      median_age_born_this_state_err REAL,
      median_age_born_other_state REAL,
      median_age_born_other_state_err REAL,
      median_age_born_outside_us REAL,
      median_age_born_outside_us_err REAL,
      male REAL,
      male_err REAL,
      male_born_this_state REAL,
      male_born_this_state_err REAL,
      male_born_other_state REAL,
      male_born_other_state_err REAL,
      male_born_outside_us REAL,
      male_born_outside_us_err REAL,
      female REAL,
      female_err REAL,
      female_born_this_state REAL,
      female_born_this_state_err REAL,
      female_born_other_state REAL,
      female_born_other_state_err REAL,
      female_born_outside_us REAL,
      female_born_outside_us_err REAL,
      one_race REAL,
      one_race_err REAL,
      one_race_born_this_state REAL,
      one_race_born_this_state_err REAL,
      one_race_born_other_state REAL,
      one_race_born_other_state_err REAL,
      one_race_born_outside_us REAL,
      one_race_born_outside_us_err REAL,
      white_race REAL,
      white_race_err REAL,
      white_race_born_this_state REAL,
      white_race_born_this_state_err REAL,
      white_race_born_other_state REAL,
      white_race_born_other_state_err REAL,
      white_race_born_outside_us REAL,
      white_race_born_outside_us_err REAL,
      black_race REAL,
      black_race_err REAL,
      black_race_born_this_state REAL,
      black_race_born_this_state_err REAL,
      black_race_born_other_state_err REAL,
      black_race_born_other_state REAL,
      black_race_born_outside_us REAL,
      black_race_born_outside_us_err REAL,
      native_race REAL,
      native_race_err REAL,
      native_race_born_this_state REAL,
      native_race_born_this_state_err REAL,
      native_race_born_other_state REAL,
      native_race_born_other_state_err REAL,
      native_race_born_outside_us REAL,
      native_race_born_outside_us_err REAL,
      asian_race REAL,
      asian_race_err REAL,
      asian_race_born_this_state REAL,
      asian_race_born_this_state_err REAL,
      asian_race_born_other_state REAL,
      asian_race_born_other_state_err REAL,
      asian_race_born_outside_us REAL,
      asian_race_born_outside_us_err REAL,
      hawaii_pacific_race REAL,
      hawaii_pacific_race_err REAL,
      hawaii_pacific_race_born_this_state REAL,
      hawaii_pacific_race_born_this_state_err REAL,
      hawaii_pacific_race_born_other_state REAL,
      hawaii_pacific_race_born_other_state_err REAL,
      hawaii_pacific_race_born_outside_us REAL,
      hawaii_pacific_race_born_outside_us_err REAL,
      other_race REAL,
      other_race_err REAL,
      other_race_born_this_state REAL,
      other_race_born_this_state_err REAL,
      other_race_born_other_state REAL,
      other_race_born_other_state_err REAL,
      other_race_born_outside_us REAL,
      other_race_born_outside_us_err REAL,
      multiple_races REAL,
      multiple_races_err REAL,
      multiple_races_born_this_state REAL,
      multiple_races_born_this_state_err REAL,
      multiple_races_born_other_state REAL,
      multiple_races_born_other_state_err REAL,
      multiple_races_born_outside_us REAL,
      multiple_races_born_outside_us_err REAL,
      hispanic_latino REAL,
      hispanic_latino_err REAL,
      hispanic_latino_born_this_state REAL,
      hispanic_latino_born_this_state_err REAL,
      hispanic_latino_born_other_state REAL,
      hispanic_latino_born_other_state_err REAL,
      hispanic_latino_born_outside_us REAL,
      hispanic_latino_born_outside_us_err REAL,
      white_not_hispanic REAL,
      white_not_hispanic_err REAL,
      white_not_hispanic_born_this_state REAL,
      white_not_hispanic_born_this_state_err REAL,
      white_not_hispanic_born_other_state_err REAL,
      white_not_hispanic_born_other_state REAL,
      white_not_hispanic_born_outside_us REAL,
      white_not_hispanic_born_outside_us_err REAL,
      age_5_plus REAL,
      age_5_plus_err REAL,
      age_5_plus_born_this_state REAL,
      age_5_plus_born_this_state_err REAL,
      age_5_plus_born_other_state REAL,
      age_5_plus_born_other_state_err REAL,
      age_5_plus_born_outside_us REAL,
      age_5_plus_born_outside_us_err REAL,
      other_language_home REAL,
      other_language_home_err REAL,
      other_language_home_born_this_state REAL,
      other_language_home_born_this_state_err REAL,
      other_language_home_born_other_state REAL,
      other_language_home_born_other_state_err REAL,
      other_language_home_born_outside_us REAL,
      other_language_home_born_outside_us_err REAL,
      other_language_home_speak_english REAL,
      other_language_home_speak_english_err REAL,
      other_language_home_speak_english_born_this_state REAL,
      other_language_home_speak_english_born_this_state_err REAL,
      other_language_home_speak_english_born_other_state REAL,
      other_language_home_speak_english_born_other_state_err REAL,
      other_language_home_speak_english_born_outside_us REAL,
      other_language_home_speak_english_born_outside_us_err REAL,
      other_language_home_poor_english REAL,
      other_language_home_poor_english_err REAL,
      other_language_home_poor_english_born_this_state REAL,
      other_language_home_poor_english_born_this_state_err REAL,
      other_language_home_poor_english_born_other_state REAL,
      other_language_home_poor_english_born_other_state_err REAL,
      other_language_home_poor_english_born_outside_us REAL,
      other_language_home_poor_english_born_outside_us_err REAL,
      age_15_plus REAL,
      age_15_plus_err REAL,
      age_15_plus_born_this_state REAL,
      age_15_plus_born_this_state_err REAL,
      age_15_plus_born_other_state REAL,
      age_15_plus_born_other_state_err REAL,
      age_15_plus_born_outside_us REAL,
      age_15_plus_born_outside_us_err REAL,
      never_married REAL,
      never_married_err REAL,
      never_married_born_this_state REAL,
      never_married_born_this_state_err REAL,
      never_married_born_other_state REAL,
      never_married_born_other_state_err REAL,
      never_married_born_outside_us REAL,
      never_married_born_outside_us_err REAL,
      now_married_separated REAL,
      now_married_separated_err REAL,
      now_married_separated_born_this_state REAL,
      now_married_separated_born_this_state_err REAL,
      now_married_separated_born_other_state REAL,
      now_married_separated_born_other_state_err REAL,
      now_married_separated_born_outside_us REAL,
      now_married_separated_born_outside_us_err REAL,
      divorced_separated REAL,
      divorced_separated_err REAL,
      divorced_separated_born_this_state REAL,
      divorced_separated_born_this_state_err REAL,
      divorced_separated_born_other_state REAL,
      divorced_separated_born_other_state_err REAL,
      divorced_separated_born_outside_us REAL,
      divorced_separated_born_outside_us_err REAL,
      widowed REAL,
      widowed_err REAL,
      widowed_born_this_state REAL,
      widowed_born_this_state_err REAL,
      widowed_born_other_state REAL,
      widowed_born_other_state_err REAL,
      widowed_born_outside_us REAL,
      widowed_born_outside_us_err REAL,
      age_25_plus REAL,
      age_25_plus_err REAL,
      age_25_plus_born_this_state REAL,
      age_25_plus_born_this_state_err REAL,
      age_25_plus_born_other_state REAL,
      age_25_plus_born_other_state_err REAL,
      age_25_plus_born_outside_us REAL,
      age_25_plus_born_outside_us_err REAL,
      ed_less_than_hs REAL,
      ed_less_than_hs_err REAL,
      ed_less_than_hs_born_this_state REAL,
      ed_less_than_hs_born_this_state_err REAL,
      ed_less_than_hs_born_other_state REAL,
      ed_less_than_hs_born_other_state_err REAL,
      ed_less_than_hs_born_outside_us REAL,
      ed_less_than_hs_born_outside_us_err REAL,
      ed_hs_grad REAL,
      ed_hs_grad_err REAL,
      ed_hs_grad_born_this_state REAL,
      ed_hs_grad_born_this_state_err REAL,
      ed_hs_grad_born_other_state REAL,
      ed_hs_grad_born_other_state_err REAL,
      ed_hs_grad_born_outside_us REAL,
      ed_hs_grad_born_outside_us_err REAL,
      ed_some_college REAL,
      ed_some_college_err REAL,
      ed_some_college_born_this_state REAL,
      ed_some_college_born_this_state_err REAL,
      ed_some_college_born_other_state REAL,
      ed_some_college_born_other_state_err REAL,
      ed_some_college_born_outside_us REAL,
      ed_some_college_born_outside_us_err REAL,
      ed_bachelors REAL,
      ed_bachelors_err REAL,
      ed_bachelors_born_this_state REAL,
      ed_bachelors_born_this_state_err REAL,
      ed_bachelors_born_other_state REAL,
      ed_bachelors_born_other_state_err REAL,
      ed_bachelors_born_outside_us REAL,
      ed_bachelors_born_outside_us_err REAL,
      ed_graduate_prof_deg REAL,
      ed_graduate_prof_deg_err REAL,
      ed_graduate_prof_deg_born_this_state REAL,
      ed_graduate_prof_deg_born_this_state_err REAL,
      ed_graduate_prof_deg_born_other_state REAL,
      ed_graduate_prof_deg_born_other_state_err REAL,
      ed_graduate_prof_deg_born_outside_us REAL,
      ed_graduate_prof_deg_born_outside_us_err REAL,
      age_15_plus_inc REAL,
      age_15_plus_inc_err REAL,
      age_15_plus_inc_born_this_state REAL,
      age_15_plus_inc_born_this_state_err REAL,
      age_15_plus_inc_born_other_state REAL,
      age_15_plus_inc_born_other_state_err REAL,
      age_15_plus_inc_born_outside_us REAL,
      age_15_plus_inc_born_outside_us_err REAL,
      income_1_10k REAL,
      income_1_10k_err REAL,
      income_1_10k_born_this_state REAL,
      income_1_10k_born_this_state_err REAL,
      income_1_10k_born_other_state REAL,
      income_1_10k_born_other_state_err REAL,
      income_1_10k_born_outside_us REAL,
      income_1_10k_born_outside_us_err REAL,
      income_10k_15k REAL,
      income_10k_15k_err REAL,
      income_10k_15k_born_this_state REAL,
      income_10k_15k_born_this_state_err REAL,
      income_10k_15k_born_other_state REAL,
      income_10k_15k_born_other_state_err REAL,
      income_10k_15k_born_outside_us REAL,
      income_10k_15k_born_outside_us_err REAL,
      income_15k_25k REAL,
      income_15k_25k_err REAL,
      income_15k_25k_born_this_state REAL,
      income_15k_25k_born_this_state_err REAL,
      income_15k_25k_born_other_state REAL,
      income_15k_25k_born_other_state_err REAL,
      income_15k_25k_born_outside_us REAL,
      income_15k_25k_born_outside_us_err REAL,
      income_25k_35k REAL,
      income_25k_35k_err REAL,
      income_25k_35k_born_this_state REAL,
      income_25k_35k_born_this_state_err REAL,
      income_25k_35k_born_other_state REAL,
      income_25k_35k_born_other_state_err REAL,
      income_25k_35k_born_outside_us REAL,
      income_25k_35k_born_outside_us_err REAL,
      income_35k_50k REAL,
      income_35k_50k_err REAL,
      income_35k_50k_born_this_state REAL,
      income_35k_50k_born_this_state_err REAL,
      income_35k_50k_born_other_state REAL,
      income_35k_50k_born_other_state_err REAL,
      income_35k_50k_born_outside_us REAL,
      income_35k_50k_born_outside_us_err REAL,
      income_50k_65k REAL,
      income_50k_65k_err REAL,
      income_50k_65k_born_this_state REAL,
      income_50k_65k_born_this_state_err REAL,
      income_50k_65k_born_other_state REAL,
      income_50k_65k_born_other_state_err REAL,
      income_50k_65k_born_outside_us REAL,
      income_50k_65k_born_outside_us_err REAL,
      income_65k_75k REAL,
      income_65k_75k_err REAL,
      income_65k_75k_born_this_state REAL,
      income_65k_75k_born_this_state_err REAL,
      income_65k_75k_born_other_state REAL,
      income_65k_75k_born_other_state_err REAL,
      income_65k_75k_born_outside_us REAL,
      income_65k_75k_born_outside_us_err REAL,
      income_75k_plus REAL,
      income_75k_plus_err REAL,
      income_75k_plus_born_this_state REAL,
      income_75k_plus_born_this_state_err REAL,
      income_75k_plus_born_other_state REAL,
      income_75k_plus_born_other_state_err REAL,
      income_75k_plus_born_outside_us REAL,
      income_75k_plus_born_outside_us_err REAL,
      median_income REAL,
      median_income_err REAL,
      median_income_born_this_state REAL,
      median_income_born_this_state_err REAL,
      median_income_born_other_state REAL,
      median_incomes_born_other_state_err REAL,
      median_income_born_outside_us REAL,
      median_income_born_outside_us_err REAL,
      poverty_status_known REAL,
      poverty_status_known_err REAL,
      poverty_status_known_born_this_state REAL,
      poverty_status_known_born_this_state_err REAL,
      poverty_status_known_born_other_state REAL,
      poverty_status_known_born_other_state_err REAL,
      poverty_status_known_born_outside_us REAL,
      poverty_status_known_born_outside_us_err REAL,
      below_poverty REAL,
      below_poverty_err REAL,
      below_poverty_born_this_state REAL,
      below_poverty_born_this_state_err REAL,
      below_poverty_born_other_state REAL,
      below_poverty_born_other_state_err REAL,
      below_poverty_born_outside_us REAL,
      below_poverty_born_outside_us_err REAL,
      below_100_150perc_poverty REAL,
      below_100_150perc_poverty_err REAL,
      below_100_150perc_poverty_born_this_state REAL,
      below_100_150perc_poverty_born_this_state_err REAL,
      below_100_150perc_poverty_born_other_state REAL,
      below_100_150perc_poverty_born_other_state_err REAL,
      below_100_150perc_poverty_born_outside_us REAL,
      below_100_150perc_poverty_born_outside_us_err REAL,
      above_150perc_poverty REAL,
      above_150perc_poverty_err REAL,
      above_150perc_poverty_born_this_state REAL,
      above_150perc_poverty_born_this_state_err REAL,
      above_150perc_poverty_born_other_state REAL,
      above_150perc_poverty_born_other_state_err REAL,
      above_150perc_poverty_born_outside_us REAL,
      above_150perc_poverty_born_outside_us_err REAL,
      citizen_status REAL,
      citizen_status_err REAL,
      citizen_status_born_this_state REAL,
      citizen_status_born_this_state_err REAL,
      citizen_status_born_other_state REAL,
      citizen_status_born_other_state_err REAL,
      citizen_status_born_outside_us REAL,
      citizen_status_born_outside_us_err REAL,
      place_of_birth REAL,
      place_of_birth_err REAL,
      place_of_birth_born_this_state REAL,
      place_of_birth_born_this_state_err REAL,
      place_of_birth_born_other_state REAL,
      place_of_birth_born_other_state_err REAL,
      place_of_birth_born_outside_us REAL,
      place_of_birth_born_outside_us_err REAL);

    -- Create temp_geo for ACS 2011 tract data
    CREATE TABLE temp_county_11(
      geo_id_long TEXT,
      geoid INTEGER NOT NULL PRIMARY KEY,
      name TEXT,
      total_pop INTEGER,
      total_pop_err INTEGER,
      born_this_state_total INTEGER,
      born_this_state_total_err INTEGER,
      born_other_state_total INTEGER,
      born_other_state_total_err INTEGER,
      born_outside_us_total INTEGER,
      born_outside_us_total_err INTEGER,
      age_0_5 REAL,
      age_0_5_err REAL,
      born_this_state_age_0_5 REAL,
      born_this_state_age_0_5_err REAL,
      born_other_state_age_0_5 REAL,
      born_other_state_age_0_5_err REAL,
      born_outside_us_age_0_5 REAL,
      born_outside_us_age_0_5_err REAL,
      age_5_17 REAL,
      age_5_17_err REAL,
      born_this_state_age_5_17 REAL,
      born_this_state_age_5_17_err REAL,
      born_other_state_age_5_17 REAL,
      born_other_state_age_5_17_err REAL,
      born_outside_us_age_5_17 REAL,
      born_outside_us_age_5_17_err REAL,
      age_18_24 REAL,
      age_18_24_err REAL,
      born_this_state_age_18_24 REAL,
      born_this_state_age_18_24_err REAL,
      born_other_state_age_18_24 REAL,
      born_other_state_age_18_24_err REAL,
      born_outside_us_age_18_24 REAL,
      born_outside_us_age_18_24_err REAL,
      age_25_44 REAL,
      age_25_44_err REAL,
      born_this_state_age_25_44 REAL,
      born_this_state_age_25_44_err REAL,
      born_other_state_age_25_44 REAL,
      born_other_state_age_25_44_err REAL,
      born_outside_us_age_25_44 REAL,
      born_outside_us_age_25_44_err REAL,
      age_45_54 REAL,
      age_45_54_err REAL,
      born_this_state_age_45_54 REAL,
      born_this_state_age_45_54_err REAL,
      born_other_state_age_45_54 REAL,
      born_other_state_age_45_54_err REAL,
      born_outside_us_age_45_54 REAL,
      born_outside_us_age_45_54_err REAL,
      age_55_64 REAL,
      age_55_64_err REAL,
      born_this_state_age_55_64 REAL,
      born_this_state_age_55_64_err REAL,
      born_other_state_age_55_64 REAL,
      born_other_state_age_55_64_err REAL,
      born_outside_us_age_55_64 REAL,
      born_outside_us_age_55_64_err REAL,
      age_65_74 REAL,
      age_65_74_err REAL,
      born_this_state_age_65_74 REAL,
      born_this_state_age_65_74_err REAL,
      born_other_state_age_65_74 REAL,
      born_other_state_age_65_74_err REAL,
      born_outside_us_age_65_74 REAL,
      born_outside_us_age_65_74_err REAL,
      age_75_plus REAL,
      age_75_plus_err REAL,
      born_this_state_age_75_plus REAL,
      born_this_state_age_75_plus_err REAL,
      born_other_state_age_75_plus REAL,
      born_other_state_age_75_plus_err REAL,
      born_outside_us_age_75_plus REAL,
      born_outside_us_age_75_plus_err REAL,
      median_age REAL,
      median_age_err REAL,
      median_age_born_this_state REAL,
      median_age_born_this_state_err REAL,
      median_age_born_other_state REAL,
      median_age_born_other_state_err REAL,
      median_age_born_outside_us REAL,
      median_age_born_outside_us_err REAL,
      male REAL,
      male_err REAL,
      male_born_this_state REAL,
      male_born_this_state_err REAL,
      male_born_other_state REAL,
      male_born_other_state_err REAL,
      male_born_outside_us REAL,
      male_born_outside_us_err REAL,
      female REAL,
      female_err REAL,
      female_born_this_state REAL,
      female_born_this_state_err REAL,
      female_born_other_state REAL,
      female_born_other_state_err REAL,
      female_born_outside_us REAL,
      female_born_outside_us_err REAL,
      one_race REAL,
      one_race_err REAL,
      one_race_born_this_state REAL,
      one_race_born_this_state_err REAL,
      one_race_born_other_state REAL,
      one_race_born_other_state_err REAL,
      one_race_born_outside_us REAL,
      one_race_born_outside_us_err REAL,
      white_race REAL,
      white_race_err REAL,
      white_race_born_this_state REAL,
      white_race_born_this_state_err REAL,
      white_race_born_other_state REAL,
      white_race_born_other_state_err REAL,
      white_race_born_outside_us REAL,
      white_race_born_outside_us_err REAL,
      black_race REAL,
      black_race_err REAL,
      black_race_born_this_state REAL,
      black_race_born_this_state_err REAL,
      black_race_born_other_state_err REAL,
      black_race_born_other_state REAL,
      black_race_born_outside_us REAL,
      black_race_born_outside_us_err REAL,
      native_race REAL,
      native_race_err REAL,
      native_race_born_this_state REAL,
      native_race_born_this_state_err REAL,
      native_race_born_other_state REAL,
      native_race_born_other_state_err REAL,
      native_race_born_outside_us REAL,
      native_race_born_outside_us_err REAL,
      asian_race REAL,
      asian_race_err REAL,
      asian_race_born_this_state REAL,
      asian_race_born_this_state_err REAL,
      asian_race_born_other_state REAL,
      asian_race_born_other_state_err REAL,
      asian_race_born_outside_us REAL,
      asian_race_born_outside_us_err REAL,
      hawaii_pacific_race REAL,
      hawaii_pacific_race_err REAL,
      hawaii_pacific_race_born_this_state REAL,
      hawaii_pacific_race_born_this_state_err REAL,
      hawaii_pacific_race_born_other_state REAL,
      hawaii_pacific_race_born_other_state_err REAL,
      hawaii_pacific_race_born_outside_us REAL,
      hawaii_pacific_race_born_outside_us_err REAL,
      other_race REAL,
      other_race_err REAL,
      other_race_born_this_state REAL,
      other_race_born_this_state_err REAL,
      other_race_born_other_state REAL,
      other_race_born_other_state_err REAL,
      other_race_born_outside_us REAL,
      other_race_born_outside_us_err REAL,
      multiple_races REAL,
      multiple_races_err REAL,
      multiple_races_born_this_state REAL,
      multiple_races_born_this_state_err REAL,
      multiple_races_born_other_state REAL,
      multiple_races_born_other_state_err REAL,
      multiple_races_born_outside_us REAL,
      multiple_races_born_outside_us_err REAL,
      hispanic_latino REAL,
      hispanic_latino_err REAL,
      hispanic_latino_born_this_state REAL,
      hispanic_latino_born_this_state_err REAL,
      hispanic_latino_born_other_state REAL,
      hispanic_latino_born_other_state_err REAL,
      hispanic_latino_born_outside_us REAL,
      hispanic_latino_born_outside_us_err REAL,
      white_not_hispanic REAL,
      white_not_hispanic_err REAL,
      white_not_hispanic_born_this_state REAL,
      white_not_hispanic_born_this_state_err REAL,
      white_not_hispanic_born_other_state_err REAL,
      white_not_hispanic_born_other_state REAL,
      white_not_hispanic_born_outside_us REAL,
      white_not_hispanic_born_outside_us_err REAL,
      age_5_plus REAL,
      age_5_plus_err REAL,
      age_5_plus_born_this_state REAL,
      age_5_plus_born_this_state_err REAL,
      age_5_plus_born_other_state REAL,
      age_5_plus_born_other_state_err REAL,
      age_5_plus_born_outside_us REAL,
      age_5_plus_born_outside_us_err REAL,
      other_language_home REAL,
      other_language_home_err REAL,
      other_language_home_born_this_state REAL,
      other_language_home_born_this_state_err REAL,
      other_language_home_born_other_state REAL,
      other_language_home_born_other_state_err REAL,
      other_language_home_born_outside_us REAL,
      other_language_home_born_outside_us_err REAL,
      other_language_home_speak_english REAL,
      other_language_home_speak_english_err REAL,
      other_language_home_speak_english_born_this_state REAL,
      other_language_home_speak_english_born_this_state_err REAL,
      other_language_home_speak_english_born_other_state REAL,
      other_language_home_speak_english_born_other_state_err REAL,
      other_language_home_speak_english_born_outside_us REAL,
      other_language_home_speak_english_born_outside_us_err REAL,
      other_language_home_poor_english REAL,
      other_language_home_poor_english_err REAL,
      other_language_home_poor_english_born_this_state REAL,
      other_language_home_poor_english_born_this_state_err REAL,
      other_language_home_poor_english_born_other_state REAL,
      other_language_home_poor_english_born_other_state_err REAL,
      other_language_home_poor_english_born_outside_us REAL,
      other_language_home_poor_english_born_outside_us_err REAL,
      age_15_plus REAL,
      age_15_plus_err REAL,
      age_15_plus_born_this_state REAL,
      age_15_plus_born_this_state_err REAL,
      age_15_plus_born_other_state REAL,
      age_15_plus_born_other_state_err REAL,
      age_15_plus_born_outside_us REAL,
      age_15_plus_born_outside_us_err REAL,
      never_married REAL,
      never_married_err REAL,
      never_married_born_this_state REAL,
      never_married_born_this_state_err REAL,
      never_married_born_other_state REAL,
      never_married_born_other_state_err REAL,
      never_married_born_outside_us REAL,
      never_married_born_outside_us_err REAL,
      now_married_separated REAL,
      now_married_separated_err REAL,
      now_married_separated_born_this_state REAL,
      now_married_separated_born_this_state_err REAL,
      now_married_separated_born_other_state REAL,
      now_married_separated_born_other_state_err REAL,
      now_married_separated_born_outside_us REAL,
      now_married_separated_born_outside_us_err REAL,
      divorced_separated REAL,
      divorced_separated_err REAL,
      divorced_separated_born_this_state REAL,
      divorced_separated_born_this_state_err REAL,
      divorced_separated_born_other_state REAL,
      divorced_separated_born_other_state_err REAL,
      divorced_separated_born_outside_us REAL,
      divorced_separated_born_outside_us_err REAL,
      widowed REAL,
      widowed_err REAL,
      widowed_born_this_state REAL,
      widowed_born_this_state_err REAL,
      widowed_born_other_state REAL,
      widowed_born_other_state_err REAL,
      widowed_born_outside_us REAL,
      widowed_born_outside_us_err REAL,
      age_25_plus REAL,
      age_25_plus_err REAL,
      age_25_plus_born_this_state REAL,
      age_25_plus_born_this_state_err REAL,
      age_25_plus_born_other_state REAL,
      age_25_plus_born_other_state_err REAL,
      age_25_plus_born_outside_us REAL,
      age_25_plus_born_outside_us_err REAL,
      ed_less_than_hs REAL,
      ed_less_than_hs_err REAL,
      ed_less_than_hs_born_this_state REAL,
      ed_less_than_hs_born_this_state_err REAL,
      ed_less_than_hs_born_other_state REAL,
      ed_less_than_hs_born_other_state_err REAL,
      ed_less_than_hs_born_outside_us REAL,
      ed_less_than_hs_born_outside_us_err REAL,
      ed_hs_grad REAL,
      ed_hs_grad_err REAL,
      ed_hs_grad_born_this_state REAL,
      ed_hs_grad_born_this_state_err REAL,
      ed_hs_grad_born_other_state REAL,
      ed_hs_grad_born_other_state_err REAL,
      ed_hs_grad_born_outside_us REAL,
      ed_hs_grad_born_outside_us_err REAL,
      ed_some_college REAL,
      ed_some_college_err REAL,
      ed_some_college_born_this_state REAL,
      ed_some_college_born_this_state_err REAL,
      ed_some_college_born_other_state REAL,
      ed_some_college_born_other_state_err REAL,
      ed_some_college_born_outside_us REAL,
      ed_some_college_born_outside_us_err REAL,
      ed_bachelors REAL,
      ed_bachelors_err REAL,
      ed_bachelors_born_this_state REAL,
      ed_bachelors_born_this_state_err REAL,
      ed_bachelors_born_other_state REAL,
      ed_bachelors_born_other_state_err REAL,
      ed_bachelors_born_outside_us REAL,
      ed_bachelors_born_outside_us_err REAL,
      ed_graduate_prof_deg REAL,
      ed_graduate_prof_deg_err REAL,
      ed_graduate_prof_deg_born_this_state REAL,
      ed_graduate_prof_deg_born_this_state_err REAL,
      ed_graduate_prof_deg_born_other_state REAL,
      ed_graduate_prof_deg_born_other_state_err REAL,
      ed_graduate_prof_deg_born_outside_us REAL,
      ed_graduate_prof_deg_born_outside_us_err REAL,
      age_15_plus_inc REAL,
      age_15_plus_inc_err REAL,
      age_15_plus_inc_born_this_state REAL,
      age_15_plus_inc_born_this_state_err REAL,
      age_15_plus_inc_born_other_state REAL,
      age_15_plus_inc_born_other_state_err REAL,
      age_15_plus_inc_born_outside_us REAL,
      age_15_plus_inc_born_outside_us_err REAL,
      income_1_10k REAL,
      income_1_10k_err REAL,
      income_1_10k_born_this_state REAL,
      income_1_10k_born_this_state_err REAL,
      income_1_10k_born_other_state REAL,
      income_1_10k_born_other_state_err REAL,
      income_1_10k_born_outside_us REAL,
      income_1_10k_born_outside_us_err REAL,
      income_10k_15k REAL,
      income_10k_15k_err REAL,
      income_10k_15k_born_this_state REAL,
      income_10k_15k_born_this_state_err REAL,
      income_10k_15k_born_other_state REAL,
      income_10k_15k_born_other_state_err REAL,
      income_10k_15k_born_outside_us REAL,
      income_10k_15k_born_outside_us_err REAL,
      income_15k_25k REAL,
      income_15k_25k_err REAL,
      income_15k_25k_born_this_state REAL,
      income_15k_25k_born_this_state_err REAL,
      income_15k_25k_born_other_state REAL,
      income_15k_25k_born_other_state_err REAL,
      income_15k_25k_born_outside_us REAL,
      income_15k_25k_born_outside_us_err REAL,
      income_25k_35k REAL,
      income_25k_35k_err REAL,
      income_25k_35k_born_this_state REAL,
      income_25k_35k_born_this_state_err REAL,
      income_25k_35k_born_other_state REAL,
      income_25k_35k_born_other_state_err REAL,
      income_25k_35k_born_outside_us REAL,
      income_25k_35k_born_outside_us_err REAL,
      income_35k_50k REAL,
      income_35k_50k_err REAL,
      income_35k_50k_born_this_state REAL,
      income_35k_50k_born_this_state_err REAL,
      income_35k_50k_born_other_state REAL,
      income_35k_50k_born_other_state_err REAL,
      income_35k_50k_born_outside_us REAL,
      income_35k_50k_born_outside_us_err REAL,
      income_50k_65k REAL,
      income_50k_65k_err REAL,
      income_50k_65k_born_this_state REAL,
      income_50k_65k_born_this_state_err REAL,
      income_50k_65k_born_other_state REAL,
      income_50k_65k_born_other_state_err REAL,
      income_50k_65k_born_outside_us REAL,
      income_50k_65k_born_outside_us_err REAL,
      income_65k_75k REAL,
      income_65k_75k_err REAL,
      income_65k_75k_born_this_state REAL,
      income_65k_75k_born_this_state_err REAL,
      income_65k_75k_born_other_state REAL,
      income_65k_75k_born_other_state_err REAL,
      income_65k_75k_born_outside_us REAL,
      income_65k_75k_born_outside_us_err REAL,
      income_75k_plus REAL,
      income_75k_plus_err REAL,
      income_75k_plus_born_this_state REAL,
      income_75k_plus_born_this_state_err REAL,
      income_75k_plus_born_other_state REAL,
      income_75k_plus_born_other_state_err REAL,
      income_75k_plus_born_outside_us REAL,
      income_75k_plus_born_outside_us_err REAL,
      median_income REAL,
      median_income_err REAL,
      median_income_born_this_state REAL,
      median_income_born_this_state_err REAL,
      median_income_born_other_state REAL,
      median_incomes_born_other_state_err REAL,
      median_income_born_outside_us REAL,
      median_income_born_outside_us_err REAL,
      poverty_status_known REAL,
      poverty_status_known_err REAL,
      poverty_status_known_born_this_state REAL,
      poverty_status_known_born_this_state_err REAL,
      poverty_status_known_born_other_state REAL,
      poverty_status_known_born_other_state_err REAL,
      poverty_status_known_born_outside_us REAL,
      poverty_status_known_born_outside_us_err REAL,
      below_poverty REAL,
      below_poverty_err REAL,
      below_poverty_born_this_state REAL,
      below_poverty_born_this_state_err REAL,
      below_poverty_born_other_state REAL,
      below_poverty_born_other_state_err REAL,
      below_poverty_born_outside_us REAL,
      below_poverty_born_outside_us_err REAL,
      below_100_150perc_poverty REAL,
      below_100_150perc_poverty_err REAL,
      below_100_150perc_poverty_born_this_state REAL,
      below_100_150perc_poverty_born_this_state_err REAL,
      below_100_150perc_poverty_born_other_state REAL,
      below_100_150perc_poverty_born_other_state_err REAL,
      below_100_150perc_poverty_born_outside_us REAL,
      below_100_150perc_poverty_born_outside_us_err REAL,
      above_150perc_poverty REAL,
      above_150perc_poverty_err REAL,
      above_150perc_poverty_born_this_state REAL,
      above_150perc_poverty_born_this_state_err REAL,
      above_150perc_poverty_born_other_state REAL,
      above_150perc_poverty_born_other_state_err REAL,
      above_150perc_poverty_born_outside_us REAL,
      above_150perc_poverty_born_outside_us_err REAL,
      citizen_status REAL,
      citizen_status_err REAL,
      citizen_status_born_this_state REAL,
      citizen_status_born_this_state_err REAL,
      citizen_status_born_other_state REAL,
      citizen_status_born_other_state_err REAL,
      citizen_status_born_outside_us REAL,
      citizen_status_born_outside_us_err REAL,
      place_of_birth REAL,
      place_of_birth_err REAL,
      place_of_birth_born_this_state REAL,
      place_of_birth_born_this_state_err REAL,
      place_of_birth_born_other_state REAL,
      place_of_birth_born_other_state_err REAL,
      place_of_birth_born_outside_us REAL,
      place_of_birth_born_outside_us_err REAL);

    -- Create 2016 geo table without unneeded columns
    CREATE TABLE county_16 (
      geoid INTEGER NOT NULL PRIMARY KEY,
      name TEXT,
      perc_insured REAL,
      perc_under_18_insured REAL,
      avg_household_size REAL,
      unemployment_rate REAL,
      total_pop INTEGER,
      age_0_5 REAL,
      age_5_17 REAL,
      age_18_24 REAL,
      age_25_44 REAL,
      age_45_54 REAL,
      age_55_64 REAL,
      age_65_74 REAL,
      age_75_plus REAL,
      median_age REAL,
      male REAL,
      female REAL,
      one_race REAL,
      white_race REAL,
      black_race REAL,
      native_race REAL,
      asian_race REAL,
      hawaii_pacific_race REAL,
      other_race REAL,
      multiple_races REAL,
      hispanic_latino REAL,
      white_not_hispanic REAL,
      age_5_plus REAL,
      other_language_home REAL,
      other_language_home_speak_english REAL,
      other_language_home_poor_english REAL,
      age_15_plus REAL,
      never_married REAL,
      now_married_separated REAL,
      divorced_separated REAL,
      widowed REAL,
      age_25_plus REAL,
      ed_less_than_hs REAL,
      ed_hs_grad REAL,
      ed_some_college REAL,
      ed_bachelors REAL,
      ed_graduate_prof_deg REAL,
      age_15_plus_inc REAL,
      income_1_10k REAL,
      income_10k_15k REAL,
      income_15k_25k REAL,
      income_25k_35k REAL,
      income_35k_50k REAL,
      income_50k_65k REAL,
      income_65k_75k REAL,
      income_75k_plus REAL,
      median_income REAL,
      poverty_status_known REAL,
      below_poverty REAL,
      below_100_150perc_poverty REAL,
      above_150perc_poverty REAL,
      citizen_status REAL,
      place_of_birth REAL,
      lat,
      lon);

      -- Create 2011 ACS geo table without unneeded columns
      CREATE TABLE county_11 (
        geoid INTEGER NOT NULL PRIMARY KEY,
        name TEXT,
        avg_household_size REAL,
        unemployment_rate REAL,
        total_pop INTEGER,
        age_0_5 REAL,
        age_5_17 REAL,
        age_18_24 REAL,
        age_25_44 REAL,
        age_45_54 REAL,
        age_55_64 REAL,
        age_65_74 REAL,
        age_75_plus REAL,
        median_age REAL,
        male REAL,
        female REAL,
        one_race REAL,
        white_race REAL,
        black_race REAL,
        native_race REAL,
        asian_race REAL,
        hawaii_pacific_race REAL,
        other_race REAL,
        multiple_races REAL,
        hispanic_latino REAL,
        white_not_hispanic REAL,
        age_5_plus REAL,
        other_language_home REAL,
        other_language_home_speak_english REAL,
        other_language_home_poor_english REAL,
        age_15_plus REAL,
        never_married REAL,
        now_married_separated REAL,
        divorced_separated REAL,
        widowed REAL,
        age_25_plus REAL,
        ed_less_than_hs REAL,
        ed_hs_grad REAL,
        ed_some_college REAL,
        ed_bachelors REAL,
        ed_graduate_prof_deg REAL,
        age_15_plus_inc REAL,
        income_1_10k REAL,
        income_10k_15k REAL,
        income_15k_25k REAL,
        income_25k_35k REAL,
        income_35k_50k REAL,
        income_50k_65k REAL,
        income_65k_75k REAL,
        income_75k_plus REAL,
        median_income REAL,
        poverty_status_known REAL,
        below_poverty REAL,
        below_100_150perc_poverty REAL,
        above_150perc_poverty REAL,
        citizen_status REAL,
        place_of_birth REAL);

-- Create a temp ruca table - note that numeric and alpha columns are redundant
CREATE TABLE temp_ruca (
  state_county INTEGER,
  state TEXT,
  county TEXT,
  geoid INTEGER NOT NULL PRIMARY KEY,
  primary_ruca INTEGER,
  secondary_ruca INTEGER,
  tract_population INTEGER,
  land_area REAL,
  population_density REAL);

CREATE TABLE temp_sup_tract_16 (
  geoid INTEGER NOT NULL PRIMARY KEY,
  perc_insured REAL,
  perc_under_18_insured REAL,
  avg_household_size REAL,
  unemployment_rate REAL);

CREATE TABLE temp_sup_tract_11 (
  geoid INTEGER NOT NULL PRIMARY KEY,
  avg_household_size REAL,
  unemployment_rate REAL);

CREATE TABLE temp_tract_latlon (
  geoid INTEGER NOT NULL PRIMARY KEY,
  lat REAL,
  lon REAL);

CREATE TABLE temp_sup_county_16 (
  geoid INTEGER NOT NULL PRIMARY KEY,
  perc_insured REAL,
  perc_under_18_insured REAL,
  avg_household_size REAL,
  unemployment_rate REAL
);

CREATE TABLE temp_sup_county_11 (
  geoid INTEGER NOT NULL PRIMARY KEY,
  avg_household_size REAL,
  unemployment_rate REAL
);

CREATE TABLE temp_county_latlon (
  geoid INTEGER NOT NULL PRIMARY KEY,
  lat REAL,
  lon REAL);

-- Import data
-- Note - if will give an insertion error but that is ok. It is rejecting
-- the header which we do not want to insert anyways.
.import src/ACS16_tracts/ACS_16_5YR_S0601_with_ann.csv temp_tract_16
.import src/ACS16_tracts/ACS_16_sup_reduced.csv temp_sup_tract_16
.import src/ACS11_tracts/ACS_11_5YR_S0601_with_ann.csv temp_tract_11
.import src/ACS11_tracts/ACS_11_sup_reduced.csv temp_sup_tract_11
.import src/ACS16_counties/ACS_16_5YR_S0601_with_ann.csv temp_county_16
.import src/ACS16_counties/ACS_16_sup_reduced.csv temp_sup_county_16
.import src/ACS11_counties/ACS_11_5YR_S0601_with_ann.csv temp_county_11
.import src/ACS11_counties/ACS_11_sup_reduced.csv temp_sup_county_11
.import src/ruca2010.csv temp_ruca
.import src/tract_lat_lon.csv temp_tract_latlon
.import src/county_lat_lon.csv temp_county_latlon


-- Combine ruca and sup data
CREATE TABLE temp_ruca_sup (
  geoid INTEGER NOT NULL PRIMARY KEY,
  state TEXT,
  county TEXT,
  primary_ruca INTEGER,
  secondary_ruca INTEGER,
  land_area REAL,
  perc_insured REAL,
  perc_under_18_insured REAL,
  avg_household_size REAL,
  unemployment_rate REAL);

-- Insert combined ruca and insurance data
INSERT INTO temp_ruca_sup
SELECT
temp_ruca.geoid,
state,
county,
primary_ruca,
secondary_ruca,
land_area,
perc_insured,
perc_under_18_insured,
avg_household_size,
unemployment_rate
FROM temp_ruca INNER JOIN temp_sup_tract_16 ON temp_ruca.geoid = temp_sup_tract_16.geoid;

-- Combine temp_ruca_sup and lat-lon data
CREATE TABLE temp_ruca_sup_ll (
  geoid INTEGER NOT NULL PRIMARY KEY,
  state TEXT,
  county TEXT,
  primary_ruca INTEGER,
  secondary_ruca INTEGER,
  land_area REAL,
  perc_insured REAL,
  perc_under_18_insured REAL,
  avg_household_size REAL,
  unemployment_rate REAL,
  lat REAL,
  lon REAL);

INSERT INTO temp_ruca_sup_ll
SELECT
temp_ruca_sup.geoid,
state,
county,
primary_ruca,
secondary_ruca,
land_area,
perc_insured,
perc_under_18_insured,
avg_household_size,
unemployment_rate,
lat,
lon
FROM temp_ruca_sup LEFT OUTER JOIN temp_tract_latlon ON temp_ruca_sup.geoid = temp_tract_latlon.geoid;

CREATE TABLE temp_county_sup_ll (
  geoid INTEGER NOT NULL PRIMARY KEY,
  perc_insured REAL,
  perc_under_18_insured REAL,
  avg_household_size REAL,
  unemployment_rate REAL,
  lat REAL,
  lon REAL);

INSERT INTO temp_county_sup_ll
SELECT
temp_sup_county_16.geoid,
perc_insured,
perc_under_18_insured,
avg_household_size,
unemployment_rate,
lat,
lon
FROM temp_sup_county_16 LEFT OUTER JOIN temp_county_latlon ON temp_sup_county_16.geoid = temp_county_latlon.geoid;

-- Insert selected columns into final 2016 tract table
INSERT INTO tract_16
SELECT
temp_tract_16.geoid,
name,
state,
county,
primary_ruca,
secondary_ruca,
land_area,
perc_insured,
perc_under_18_insured,
avg_household_size,
unemployment_rate,
total_pop,
age_0_5,
age_5_17,
age_18_24,
age_25_44,
age_45_54,
age_55_64,
age_65_74,
age_75_plus,
median_age,
male,
female,
one_race,
white_race,
black_race,
native_race,
asian_race,
hawaii_pacific_race,
other_race,
multiple_races,
hispanic_latino,
white_not_hispanic,
age_5_plus,
other_language_home,
other_language_home_speak_english,
other_language_home_poor_english,
age_15_plus,
never_married,
now_married_separated,
divorced_separated,
widowed,
age_25_plus,
ed_less_than_hs,
ed_hs_grad,
ed_some_college,
ed_bachelors,
ed_graduate_prof_deg,
age_15_plus,
income_1_10k,
income_10k_15k,
income_15k_25k,
income_25k_35k,
income_35k_50k,
income_50k_65k,
income_65k_75k,
income_75k_plus,
median_income,
poverty_status_known,
below_poverty,
below_100_150perc_poverty,
above_150perc_poverty,
citizen_status,
place_of_birth,
lat,
lon
FROM temp_tract_16 LEFT OUTER JOIN temp_ruca_sup_ll
ON temp_tract_16.geoid = temp_ruca_sup_ll.geoid;

-- Insert selected columns into final 2011 tract table
INSERT INTO tract_11
SELECT
temp_tract_11.geoid,
name,
avg_household_size,
unemployment_rate,
total_pop,
age_0_5,
age_5_17,
age_18_24,
age_25_44,
age_45_54,
age_55_64,
age_65_74,
age_75_plus,
median_age,
male,
female,
one_race,
white_race,
black_race,
native_race,
asian_race,
hawaii_pacific_race,
other_race,
multiple_races,
hispanic_latino,
white_not_hispanic,
age_5_plus,
other_language_home,
other_language_home_speak_english,
other_language_home_poor_english,
age_15_plus,
never_married,
now_married_separated,
divorced_separated,
widowed,
age_25_plus,
ed_less_than_hs,
ed_hs_grad,
ed_some_college,
ed_bachelors,
ed_graduate_prof_deg,
age_15_plus,
income_1_10k,
income_10k_15k,
income_15k_25k,
income_25k_35k,
income_35k_50k,
income_50k_65k,
income_65k_75k,
income_75k_plus,
median_income,
poverty_status_known,
below_poverty,
below_100_150perc_poverty,
above_150perc_poverty,
citizen_status,
place_of_birth
FROM temp_tract_11 LEFT OUTER JOIN temp_sup_tract_11
ON temp_tract_11.geoid = temp_sup_tract_11.geoid;

-- Insert selected columns into final 2016 county table
INSERT INTO county_16
SELECT
temp_county_16.geoid,
name,
perc_insured,
perc_under_18_insured,
avg_household_size,
unemployment_rate,
total_pop,
age_0_5,
age_5_17,
age_18_24,
age_25_44,
age_45_54,
age_55_64,
age_65_74,
age_75_plus,
median_age,
male,
female,
one_race,
white_race,
black_race,
native_race,
asian_race,
hawaii_pacific_race,
other_race,
multiple_races,
hispanic_latino,
white_not_hispanic,
age_5_plus,
other_language_home,
other_language_home_speak_english,
other_language_home_poor_english,
age_15_plus,
never_married,
now_married_separated,
divorced_separated,
widowed,
age_25_plus,
ed_less_than_hs,
ed_hs_grad,
ed_some_college,
ed_bachelors,
ed_graduate_prof_deg,
age_15_plus,
income_1_10k,
income_10k_15k,
income_15k_25k,
income_25k_35k,
income_35k_50k,
income_50k_65k,
income_65k_75k,
income_75k_plus,
median_income,
poverty_status_known,
below_poverty,
below_100_150perc_poverty,
above_150perc_poverty,
citizen_status,
place_of_birth,
lat,
lon
FROM temp_county_16 LEFT OUTER JOIN temp_county_sup_ll
ON temp_county_16.geoid = temp_county_sup_ll.geoid;

-- Insert selected columns into final 2011 county table
INSERT INTO county_11
SELECT
temp_county_11.geoid,
name,
avg_household_size,
unemployment_rate,
total_pop,
age_0_5,
age_5_17,
age_18_24,
age_25_44,
age_45_54,
age_55_64,
age_65_74,
age_75_plus,
median_age,
male,
female,
one_race,
white_race,
black_race,
native_race,
asian_race,
hawaii_pacific_race,
other_race,
multiple_races,
hispanic_latino,
white_not_hispanic,
age_5_plus,
other_language_home,
other_language_home_speak_english,
other_language_home_poor_english,
age_15_plus,
never_married,
now_married_separated,
divorced_separated,
widowed,
age_25_plus,
ed_less_than_hs,
ed_hs_grad,
ed_some_college,
ed_bachelors,
ed_graduate_prof_deg,
age_15_plus,
income_1_10k,
income_10k_15k,
income_15k_25k,
income_25k_35k,
income_35k_50k,
income_50k_65k,
income_65k_75k,
income_75k_plus,
median_income,
poverty_status_known,
below_poverty,
below_100_150perc_poverty,
above_150perc_poverty,
citizen_status,
place_of_birth
FROM temp_county_11 LEFT OUTER JOIN temp_sup_county_11
ON temp_county_11.geoid = temp_sup_county_11.geoid;

DROP TABLE temp_tract_16;
DROP TABLE temp_tract_11;
DROP TABLE temp_county_16;
DROP TABLE temp_county_11;
DROP TABLE temp_sup_tract_16;
DROP TABLE temp_sup_tract_11;
DROP TABLE temp_sup_county_16;
DROP TABLE temp_sup_county_11;
DROP TABLE temp_ruca;
DROP TABLE temp_ruca_sup;
DROP TABLE temp_ruca_sup_ll;
DROP TABLE temp_tract_latlon;
DROP TABLE temp_county_latlon;

-- Create nppes table

CREATE TABLE temp_nppes (
  npi INTEGER NOT NULL PRIMARY KEY,
  entity_type_code INTEGER,
  replacement_npi INTEGER,
  employer_id_num,
  organization,
  last_name,
  first_name,
  middle_name,
  prefix_name,
  suffix_name,
  credential,
  other_organization,
  other_organization_type_code,
  other_last_name,
  other_first_name,
  other_middle_name,
  other_prefix_name,
  other_suffix_name,
  other_credential,
  other_last_name_type_code,
  first_line_mailing,
  second_line_mailing,
  city_mailing,
  state_mailing,
  postal_code_mailing,
  country_mailing,
  phone_mailing,
  fax_mailing,
  first_line_business TEXT,
  second_line_business TEXT,
  city_business TEXT,
  state_business TEXT,
  postal_code_business INTEGER,
  country_business,
  phone_business,
  fax_business,
  enum_date,
  update_date,
  deactivation_code TEXT,
  deactivation_date,
  reactivation_date,
  gender TEXT,
  official_last,
  official_first,
  official_middle,
  official_title,
  official_phone,
  taxonomy_1 TEXT,
  license_num_1,
  license_num_state_1,
  taxonomy_switch_1 TEXT,
  taxonomy_2 TEXT,
  license_num_2,
  license_num_state_2,
  taxonomy_switch_2 TEXT,
  taxonomy_3 TEXT,
  license_num_3,
  license_num_state_3,
  taxonomy_switch_3 TEXT,
  taxonomy_4 TEXT,
  license_num_4,
  license_num_state_4,
  taxonomy_switch_4 TEXT,
  taxonomy_5 TEXT,
  license_num_5,
  license_num_state_5,
  taxonomy_switch_5 TEXT,
  taxonomy_6 TEXT,
  license_num_6,
  license_num_state_6,
  taxonomy_switch_6 TEXT,
  taxonomy_7 TEXT,
  license_num_7,
  license_num_state_7,
  taxonomy_switch_7 TEXT,
  taxonomy_8 TEXT,
  license_num_8,
  license_num_state_8,
  taxonomy_switch_8 TEXT,
  taxonomy_9 TEXT,
  license_num_9,
  license_num_state_9,
  taxonomy_switch_9 TEXT,
  taxonomy_10 TEXT,
  license_num_10,
  license_num_state_10,
  taxonomy_switch_10 TEXT,
  taxonomy_11 TEXT,
  license_num_11,
  license_num_state_11,
  taxonomy_switch_11 TEXT,
  taxonomy_12 TEXT,
  license_num_12,
  license_num_state_12,
  taxonomy_switch_12 TEXT,
  taxonomy_13 TEXT,
  license_num_13,
  license_num_state_13,
  taxonomy_switch_13 TEXT,
  taxonomy_14 TEXT,
  license_num_14,
  license_num_state_14,
  taxonomy_switch_14 TEXT,
  taxonomy_15 TEXT,
  license_num_15,
  license_num_state_15,
  taxonomy_switch_15 TEXT,
  other_id_1,
  other_id_code_1,
  other_id_state_1,
  other_id_issuer_1,
  other_id_2,
  other_id_code_2,
  other_id_state_2,
  other_id_issuer_2,
  other_id_3,
  other_id_code_3,
  other_id_state_3,
  other_id_issuer_3,
  other_id_4,
  other_id_code_4,
  other_id_state_4,
  other_id_issuer_4,
  other_id_5,
  other_id_code_5,
  other_id_state_5,
  other_id_issuer_5,
  other_id_6,
  other_id_code_6,
  other_id_state_6,
  other_id_issuer_6,
  other_id_7,
  other_id_code_7,
  other_id_state_7,
  other_id_issuer_7,
  other_id_8,
  other_id_code_8,
  other_id_state_8,
  other_id_issuer_8,
  other_id_9,
  other_id_code_9,
  other_id_state_9,
  other_id_issuer_9,
  other_id_10,
  other_id_code_10,
  other_id_state_10,
  other_id_issuer_10,
  other_id_11,
  other_id_code_11,
  other_id_state_11,
  other_id_issuer_11,
  other_id_12,
  other_id_code_12,
  other_id_state_12,
  other_id_issuer_12,
  other_id_13,
  other_id_code_13,
  other_id_state_13,
  other_id_issuer_13,
  other_id_14,
  other_id_code_14,
  other_id_state_14,
  other_id_issuer_14,
  other_id_15,
  other_id_code_15,
  other_id_state_15,
  other_id_issuer_15,
  other_id_16,
  other_id_code_16,
  other_id_state_16,
  other_id_issuer_16,
  other_id_17,
  other_id_code_17,
  other_id_state_17,
  other_id_issuer_17,
  other_id_18,
  other_id_code_18,
  other_id_state_18,
  other_id_issuer_18,
  other_id_19,
  other_id_code_19,
  other_id_state_19,
  other_id_issuer_19,
  other_id_20,
  other_id_code_20,
  other_id_state_20,
  other_id_issuer_20,
  other_id_21,
  other_id_code_21,
  other_id_state_21,
  other_id_issuer_21,
  other_id_22,
  other_id_code_22,
  other_id_state_22,
  other_id_issuer_22,
  other_id_23,
  other_id_code_23,
  other_id_state_23,
  other_id_issuer_23,
  other_id_24,
  other_id_code_24,
  other_id_state_24,
  other_id_issuer_24,
  other_id_25,
  other_id_code_25,
  other_id_state_25,
  other_id_issuer_25,
  other_id_26,
  other_id_code_26,
  other_id_state_26,
  other_id_issuer_26,
  other_id_27,
  other_id_code_27,
  other_id_state_27,
  other_id_issuer_27,
  other_id_28,
  other_id_code_28,
  other_id_state_28,
  other_id_issuer_28,
  other_id_29,
  other_id_code_29,
  other_id_state_29,
  other_id_issuer_29,
  other_id_30,
  other_id_code_30,
  other_id_state_30,
  other_id_issuer_30,
  other_id_31,
  other_id_code_31,
  other_id_state_31,
  other_id_issuer_31,
  other_id_32,
  other_id_code_32,
  other_id_state_32,
  other_id_issuer_32,
  other_id_33,
  other_id_code_33,
  other_id_state_33,
  other_id_issuer_33,
  other_id_34,
  other_id_code_34,
  other_id_state_34,
  other_id_issuer_34,
  other_id_35,
  other_id_code_35,
  other_id_state_35,
  other_id_issuer_35,
  other_id_36,
  other_id_code_36,
  other_id_state_36,
  other_id_issuer_36,
  other_id_37,
  other_id_code_37,
  other_id_state_37,
  other_id_issuer_37,
  other_id_38,
  other_id_code_38,
  other_id_state_38,
  other_id_issuer_38,
  other_id_39,
  other_id_code_39,
  other_id_state_39,
  other_id_issuer_39,
  other_id_40,
  other_id_code_40,
  other_id_state_40,
  other_id_issuer_40,
  other_id_41,
  other_id_code_41,
  other_id_state_41,
  other_id_issuer_41,
  other_id_42,
  other_id_code_42,
  other_id_state_42,
  other_id_issuer_42,
  other_id_43,
  other_id_code_43,
  other_id_state_43,
  other_id_issuer_43,
  other_id_44,
  other_id_code_44,
  other_id_state_44,
  other_id_issuer_44,
  other_id_45,
  other_id_code_45,
  other_id_state_45,
  other_id_issuer_45,
  other_id_46,
  other_id_code_46,
  other_id_state_46,
  other_id_issuer_46,
  other_id_47,
  other_id_code_47,
  other_id_state_47,
  other_id_issuer_47,
  other_id_48,
  other_id_code_48,
  other_id_state_48,
  other_id_issuer_48,
  other_id_49,
  other_id_code_49,
  other_id_state_49,
  other_id_issuer_49,
  other_id_50,
  other_id_code_50,
  other_id_state_50,
  other_id_issuer_50,
  sole_proprieter,
  org_subpart,
  parent_org_lbn,
  parent_org_tin,
  official_prefix,
  official_suffix,
  official_credential,
  taxonomy_group_1,
  taxonomy_group_2,
  taxonomy_group_3,
  taxonomy_group_4,
  taxonomy_group_5,
  taxonomy_group_6,
  taxonomy_group_7,
  taxonomy_group_8,
  taxonomy_group_9,
  taxonomy_group_10,
  taxonomy_group_11,
  taxonomy_group_12,
  taxonomy_group_13,
  taxonomy_group_14,
  taxonomy_group_15);

  -- Create a taxonomy table
CREATE TABLE taxonomy (
  id TEXT PRIMARY KEY,
  name TEXT,
  description TEXT);

-- Import data
-- Note - it will give an insertion error but that is fine. It is rejecting
.import src/npidata_pfile_20050523-20180909.csv temp_nppes
.import src/taxonomy_downselect_v2.csv taxonomy

-- Create temp_nppes2 without unneeded columns
CREATE TABLE temp_nppes2 (
  npi INTEGER NOT NULL PRIMARY KEY,
  first_line_business TEXT,
  second_line_business TEXT,
  city_business TEXT,
  state_business TEXT,
  postal_code_business INTEGER,
  deactivation_code TEXT,
  gender TEXT,
  taxonomy_1 TEXT,
  taxonomy_switch_1 TEXT,
  taxonomy_2 TEXT,
  taxonomy_switch_2 TEXT,
  taxonomy_3 TEXT,
  taxonomy_switch_3 TEXT,
  taxonomy_4 TEXT,
  taxonomy_switch_4 TEXT,
  taxonomy_5 TEXT,
  taxonomy_switch_5 TEXT,
  taxonomy_6 TEXT,
  taxonomy_switch_6 TEXT,
  taxonomy_7 TEXT,
  taxonomy_switch_7 TEXT,
  taxonomy_8 TEXT,
  taxonomy_switch_8 TEXT,
  taxonomy_9 TEXT,
  taxonomy_switch_9 TEXT,
  taxonomy_10 TEXT,
  taxonomy_switch_10 TEXT,
  taxonomy_11 TEXT,
  taxonomy_switch_11 TEXT,
  taxonomy_12 TEXT,
  taxonomy_switch_12 TEXT,
  taxonomy_13 TEXT,
  taxonomy_switch_13 TEXT,
  taxonomy_14 TEXT,
  taxonomy_switch_14 TEXT,
  taxonomy_15 TEXT,
  taxonomy_switch_15 TEXT);

-- Insert selected columns into revised nppes table
INSERT INTO temp_nppes2
SELECT
  npi,
  first_line_business,
  second_line_business,
  city_business,
  state_business,
  postal_code_business,
  deactivation_code,
  gender,
  taxonomy_1,
  taxonomy_switch_1,
  taxonomy_2,
  taxonomy_switch_2,
  taxonomy_3,
  taxonomy_switch_3,
  taxonomy_4,
  taxonomy_switch_4,
  taxonomy_5,
  taxonomy_switch_5,
  taxonomy_6,
  taxonomy_switch_6,
  taxonomy_7,
  taxonomy_switch_7,
  taxonomy_8,
  taxonomy_switch_8,
  taxonomy_9,
  taxonomy_switch_9,
  taxonomy_10,
  taxonomy_switch_10,
  taxonomy_11,
  taxonomy_switch_11,
  taxonomy_12,
  taxonomy_switch_12,
  taxonomy_13,
  taxonomy_switch_13,
  taxonomy_14,
  taxonomy_switch_14,
  taxonomy_15,
  taxonomy_switch_15
FROM temp_nppes
WHERE country_business = 'US' AND entity_type_code = 1 AND state_business != 'AS'
      AND state_business != 'GU' AND state_business != 'MH' AND
      state_business != 'FM' AND state_business != 'MP' AND state_business != 'PW'
      AND state_business != 'PR' AND state_business != 'VI';

DROP TABLE temp_nppes;

--Create final nppes table with only taxonomies of interest
CREATE TABLE temp_nppes3 (
  npi INTEGER NOT NULL PRIMARY KEY,
  first_line_business TEXT,
  second_line_business TEXT,
  city_business TEXT,
  state_business TEXT,
  postal_code_business INTEGER,
  deactivation_code TEXT,
  gender TEXT,
  taxonomy TEXT);

-- Insert selected columns into final nppes table
INSERT INTO temp_nppes3
SELECT
  npi,
  first_line_business,
  second_line_business,
  city_business,
  state_business,
  postal_code_business,
  deactivation_code,
  gender,
  taxonomy_1 as taxonomy
FROM temp_nppes2 INNER JOIN taxonomy ON temp_nppes2.taxonomy_1 = taxonomy.id
WHERE taxonomy_switch_1 = 'Y'
UNION
SELECT
  npi,
  first_line_business,
  second_line_business,
  city_business,
  state_business,
  postal_code_business,
  deactivation_code,
  gender,
  taxonomy_2 as taxonomy
FROM temp_nppes2 INNER JOIN taxonomy ON temp_nppes2.taxonomy_2 = taxonomy.id
WHERE taxonomy_switch_2 = 'Y'
UNION
SELECT
  npi,
  first_line_business,
  second_line_business,
  city_business,
  state_business,
  postal_code_business,
  deactivation_code,
  gender,
  taxonomy_3 as taxonomy
FROM temp_nppes2 INNER JOIN taxonomy ON temp_nppes2.taxonomy_3 = taxonomy.id
WHERE taxonomy_switch_3 = 'Y'
UNION
SELECT
  npi,
  first_line_business,
  second_line_business,
  city_business,
  state_business,
  postal_code_business,
  deactivation_code,
  gender,
  taxonomy_4 as taxonomy
FROM temp_nppes2 INNER JOIN taxonomy ON temp_nppes2.taxonomy_4 = taxonomy.id
WHERE taxonomy_switch_4 = 'Y'
UNION
SELECT
  npi,
  first_line_business,
  second_line_business,
  city_business,
  state_business,
  postal_code_business,
  deactivation_code,
  gender,
  taxonomy_5 as taxonomy
FROM temp_nppes2 INNER JOIN taxonomy ON temp_nppes2.taxonomy_5 = taxonomy.id
WHERE taxonomy_switch_5 = 'Y'
UNION
SELECT
  npi,
  first_line_business,
  second_line_business,
  city_business,
  state_business,
  postal_code_business,
  deactivation_code,
  gender,
  taxonomy_6 as taxonomy
FROM temp_nppes2 INNER JOIN taxonomy ON temp_nppes2.taxonomy_6 = taxonomy.id
WHERE taxonomy_switch_6 = 'Y'
UNION
SELECT
  npi,
  first_line_business,
  second_line_business,
  city_business,
  state_business,
  postal_code_business,
  deactivation_code,
  gender,
  taxonomy_7 as taxonomy
FROM temp_nppes2 INNER JOIN taxonomy ON temp_nppes2.taxonomy_7 = taxonomy.id
WHERE taxonomy_switch_7 = 'Y'
UNION
SELECT
  npi,
  first_line_business,
  second_line_business,
  city_business,
  state_business,
  postal_code_business,
  deactivation_code,
  gender,
  taxonomy_8 as taxonomy
FROM temp_nppes2 INNER JOIN taxonomy ON temp_nppes2.taxonomy_8 = taxonomy.id
WHERE taxonomy_switch_8 = 'Y'
UNION
SELECT
  npi,
  first_line_business,
  second_line_business,
  city_business,
  state_business,
  postal_code_business,
  deactivation_code,
  gender,
  taxonomy_9 as taxonomy
FROM temp_nppes2 INNER JOIN taxonomy ON temp_nppes2.taxonomy_9 = taxonomy.id
WHERE taxonomy_switch_9 = 'Y'
UNION
SELECT
  npi,
  first_line_business,
  second_line_business,
  city_business,
  state_business,
  postal_code_business,
  deactivation_code,
  gender,
  taxonomy_10 as taxonomy
FROM temp_nppes2 INNER JOIN taxonomy ON temp_nppes2.taxonomy_10 = taxonomy.id
WHERE taxonomy_switch_10 = 'Y'
UNION
SELECT
  npi,
  first_line_business,
  second_line_business,
  city_business,
  state_business,
  postal_code_business,
  deactivation_code,
  gender,
  taxonomy_11 as taxonomy
FROM temp_nppes2 INNER JOIN taxonomy ON temp_nppes2.taxonomy_11 = taxonomy.id
WHERE taxonomy_switch_11 = 'Y'
UNION
SELECT
  npi,
  first_line_business,
  second_line_business,
  city_business,
  state_business,
  postal_code_business,
  deactivation_code,
  gender,
  taxonomy_12 as taxonomy
FROM temp_nppes2 INNER JOIN taxonomy ON temp_nppes2.taxonomy_12 = taxonomy.id
WHERE taxonomy_switch_12 = 'Y'
UNION
SELECT
  npi,
  first_line_business,
  second_line_business,
  city_business,
  state_business,
  postal_code_business,
  deactivation_code,
  gender,
  taxonomy_13 as taxonomy
FROM temp_nppes2 INNER JOIN taxonomy ON temp_nppes2.taxonomy_13 = taxonomy.id
WHERE taxonomy_switch_13 = 'Y'
UNION
SELECT
  npi,
  first_line_business,
  second_line_business,
  city_business,
  state_business,
  postal_code_business,
  deactivation_code,
  gender,
  taxonomy_14 as taxonomy
FROM temp_nppes2 INNER JOIN taxonomy ON temp_nppes2.taxonomy_14 = taxonomy.id
WHERE taxonomy_switch_14 = 'Y'
UNION
SELECT
  npi,
  first_line_business,
  second_line_business,
  city_business,
  state_business,
  postal_code_business,
  deactivation_code,
  gender,
  taxonomy_15 as taxonomy
FROM temp_nppes2 INNER JOIN taxonomy ON temp_nppes2.taxonomy_15 = taxonomy.id
WHERE taxonomy_switch_15 = 'Y';

DROP TABLE temp_nppes2;

CREATE TABLE nppes (
  npi INTEGER NOT NULL PRIMARY KEY,
  first_line_business TEXT,
  second_line_business TEXT,
  city_business TEXT,
  state_business TEXT,
  postal_code_business INTEGER,
  deactivation_code TEXT,
  gender TEXT,
  taxonomy TEXT,
  geoid INTEGER,
  geoid_short INTEGER,
  lat REAL,
  long REAL);

-- Create geocode table and import data
CREATE TABLE geocode (
  npi INTEGER NOT NULL PRIMARY KEY,
  lat REAL,
  long REAL,
  geoid INTEGER,
  geoid_short INTEGER);

.import src/geocode_final.csv geocode
--
-- Join geocodes to providers and split lat-long string
INSERT INTO nppes
SELECT
  temp_nppes3.npi,
  first_line_business,
  second_line_business,
  city_business,
  state_business,
  postal_code_business,
  deactivation_code,
  gender,
  taxonomy,
  geoid,
  geoid_short,
  lat,
  long
FROM temp_nppes3 INNER JOIN geocode ON temp_nppes3.npi = geocode.npi;

DROP TABLE temp_nppes3;
DROP TABLE geocode;

-- Create geocode table and import data
CREATE TABLE tract_zip (
  tract INTEGER NOT NULL PRIMARY KEY,
  zips);

.import src/tract_zip_flat.csv geocode

VACUUM;
